(this["webpackJsonppolling-app-client"]=this["webpackJsonppolling-app-client"]||[]).push([[0],{267:function(e,t,a){},270:function(e,t,a){},300:function(e,t,a){},378:function(e,t,a){},420:function(e,t,a){},421:function(e,t,a){},422:function(e,t,a){},423:function(e,t,a){},424:function(e,t,a){},425:function(e,t,a){},432:function(e,t,a){},433:function(e,t,a){},434:function(e,t,a){},437:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(35),r=a.n(s),l=(a(267),a(74),a(15)),i=a(192),c=(a(214),a(103)),u=(a(270),a(47)),m=Object({NODE_ENV:"production",PUBLIC_URL:"/poll-client",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_BASE_URL||"https://powerful-fjord-93250.herokuapp.com/api",d="accessToken",h=10,p=40,g=20,v=function(e){var t=new Headers({"Content-Type":"application/json"});localStorage.getItem(d)&&t.append("Authorization","Bearer "+localStorage.getItem(d));var a={headers:t};return e=Object.assign({},a,e),fetch(e.url,e).then((function(e){return e.json().then((function(t){return e.ok?t:Promise.reject(t)}))}))},f=function(e){var t=new Headers({Accept:"*/*"});localStorage.getItem(d)&&t.append("Authorization","Bearer "+localStorage.getItem(d));var a={headers:t};return e=Object.assign({},a,e),fetch(e.url,e).then((function(e){return e.json().then((function(t){return e.ok?t:Promise.reject(t)}))}))};function C(e,t){return v({url:m+"/polls?page="+(e=e||0)+"&size="+(t=t||h),method:"GET"})}function E(e,t,a){return v({url:m+"/polls/search?search="+e+"&page="+(t=t||0)+"&size="+(a=a||h),method:"GET"})}function y(e){return v({url:m+"/polls/"+e,method:"GET"})}function b(e,t,a){return v({url:m+"/groups/polls?code="+e+"&page="+(t=t||0)+"&size="+(a=a||h),method:"GET"})}function S(e,t){return v({url:m+"/groups?page="+(e=e||0)+"&size="+(t=t||13),method:"GET"})}function w(e,t,a){return v({url:m+"/polls/voted?choice="+e+"&page="+(t=t||0)+"&size="+(a=a||5),method:"GET"})}function P(e,t,a){return v({url:m+"/polls/"+e+"/comment?page="+(t=t||0)+"&size="+(a=a||5),method:"GET"})}function k(e){return f({url:m+"/file/upload?id="+e,method:"DELETE"})}function x(e,t){return localStorage.getItem(d)?v({url:m+"/user/find?"+t+"="+e,method:"GET"}):Promise.reject("No access token set.")}function N(e,t,a){return v({url:m+"/users/"+e+"/polls?page="+(t=t||0)+"&size="+(a=a||h),method:"GET"})}function U(e,t,a){return v({url:m+"/users/"+e+"/votes?page="+(t=t||0)+"&size="+(a=a||h),method:"GET"})}function A(e,t){return v({url:m+"/users/savepost?page="+(e=e||0)+"&size="+(t=t||h),method:"GET"})}function I(e,t){return v({url:m+"/users/notification?page="+(e=e||0)+"&size="+(t=t||h),method:"GET"})}a(271);var L=a(258),M=(a(215),a(73)),O=(a(128),a(42)),V=(a(196),a(66)),D=(a(50),a(14)),R=a(27),j=a(43),T=a(44),F=a(30),G=a(46),_=a(45),z=(a(217),a(177)),B=(a(197),a(76)),Y=(a(218),a(55)),H=(a(198),a(20)),q=(a(285),a(257)),W=(a(288),a(251)),K=(a(195),a(77)),J=(a(129),a(53)),Q=(a(291),a(145)),$=(a(293),a(143)),X=(a(208),a(105)),Z=(a(220),a(102)),ee=(a(92),a(39)),te=(a(83),a(36)),ae=(a(300),a(23)),ne=["#F44336","#e91e63","#9c27b0","#673ab7","#ff9800","#ff5722","#795548","#607d8b","#3f51b5","#2196F3","#00bcd4","#009688","#2196F3","#32c787","#00BCD4","#ff5652","#ffc107","#ff85af","#FF9800","#39bbb0","#4CAF50","#ffeb3b","#ffc107"];function oe(e){e=e.substr(0,6);for(var t=0,a=0;a<e.length;a++)t=31*t+e.charCodeAt(a);var n=Math.abs(t%ne.length);return ne[n]}function se(e){var t=new Date(e),a=t.getMonth(),n=t.getFullYear();return t.getDate()+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a]+" "+n+" - "+t.getHours()+":"+t.getMinutes()}var re=a(441),le=a(442),ie=a(262),ce=a(443),ue=a(444),me=a(445),de=a(446),he=a(260),pe=te.a.TextArea,ge=ee.a.Item,ve=Z.a.Group,fe={name:"file",action:m+"/file/upload",headers:{authorization:"Bearer "+localStorage.getItem(d)}},Ce=function(e){if(null==e)return"";var t=new Date(e).getTime(),a=(new Date).getTime()-t,n=Math.floor(a/1e3%60),o=Math.floor(a/1e3/60%60),s=Math.floor(a/36e5%24),r=Math.floor(a/864e5);return r>7?se(e):r>0?r+" ng\xe0y tr\u01b0\u1edbc":s>0?s+" gi\u1edd tr\u01b0\u1edbc":o>0?o+" ph\xfat tr\u01b0\u1edbc":n>0?n+" gi\xe2y tr\u01b0\u1edbc":"V\u1eeba m\u1edbi"},Ee=function(e){var t=e.onChange,a=e.onSubmit,n=e.submitting,s=e.value,r=e.textButton;return o.a.createElement(o.a.Fragment,null,o.a.createElement(ee.a.Item,null,o.a.createElement(pe,{rows:3,onChange:t,value:s})),o.a.createElement(ee.a.Item,{style:{marginBottom:"0px"}},o.a.createElement(D.a,{htmlType:"submit",style:{float:"right"},loading:n,onClick:a,type:"primary"},"Add ",r)))};function ye(e){return o.a.createElement("div",null,e.isOwner&&o.a.createElement(D.a,{type:"primary",style:{marginBottom:"10px"},block:!0,onClick:function(){return e.onUpdatePost(e.postIndex)}},"C\u1eadp nh\u1eadt"),e.isUserStorage?o.a.createElement(D.a,{type:"primary",style:{marginBottom:"10px"},block:!0,onClick:function(){return e.deleteFollowPost(e.postIndex)}},"H\u1ee7y L\u01b0u tr\u1eef"):o.a.createElement(D.a,{type:"primary",style:{marginBottom:"10px"},block:!0,onClick:function(){return e.onFollowPost(e.postIndex)}},"L\u01b0u tr\u1eef"),o.a.createElement(D.a,{danger:!0,block:!0,onClick:function(){return e.onDeletePost(e.postIndex)}},"Delete post"))}function be(e){return o.a.createElement("div",{className:"popInforPoll"},o.a.createElement(M.b,{dataSource:e.list,renderItem:function(e){return o.a.createElement(M.b.Item,null,o.a.createElement(M.b.Item.Meta,{title:o.a.createElement(ae.b,{to:"/groups/".concat(e.code)},e.name," ",o.a.createElement("span",{style:{color:"#657786"}},"@",e.code)),description:o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("span",null,"Ng\u01b0\u1eddi t\u1ea1o: ",o.a.createElement(ae.b,{to:"/users/".concat(e.admin.username)},e.admin.name," @",e.admin.username))),o.a.createElement("div",null,"Ng\xe0y t\u1ea1o: ",se(e.createDate)))}))}}))}function Se(e){return o.a.createElement("div",{className:"popInforPoll"},o.a.createElement(B.a,{gutter:[24,8]},o.a.createElement(H.a,{span:12},"B\u1ea7u ch\u1ecdn \u1ea9n danh\xa0")," ",o.a.createElement(H.a,{span:12},e.poll.isUnseenUserForVote?o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",defaultChecked:!0,disabled:!0}):o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",disabled:!0})),o.a.createElement(H.a,{span:12},"Cho ph\xe9p th\xeam l\u1ef1a ch\u1ecdn\xa0"),o.a.createElement(H.a,{span:12},e.poll.isAddChoice?o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",defaultChecked:!0,disabled:!0}):o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",disabled:!0})),e.poll.isAddChoice?o.a.createElement(H.a,{span:12},"Ng\u01b0\u1eddi th\xeam l\u1ef1a ch\u1ecdn b\u1ecb \u1ea9n danh\xa0"):null,e.poll.isAddChoice?o.a.createElement(H.a,{span:12},e.poll.isUnseenUserForAddChoice?o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",disabled:!0,defaultChecked:!0}):o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",disabled:!0})):null,o.a.createElement(H.a,{span:12},"Cho ph\xe9p s\u1eeda l\u1ef1a ch\u1ecdn\xa0"),o.a.createElement(H.a,{span:12},e.poll.isCanFix?o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",disabled:!0,defaultChecked:!0}):o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",disabled:!0})),o.a.createElement(H.a,{span:12},"S\u1ed1 l\u01b0\u1ee3ng phi\u1ebfu b\u1ea7u t\u1ed1i \u0111a:"),o.a.createElement(H.a,{span:12},e.poll.maxVotePerTimeLoad,"\xa0L\u1ea7n"),o.a.createElement(H.a,{span:12},"M\u1ed7i l\u1ef1a ch\u1ecdn \u0111\u01b0\u1ee3c b\u1ea7u t\u1ed1i \u0111a:"),o.a.createElement(H.a,{span:12},e.poll.maxVotePerChoice,"\xa0L\u1ea7n"),0===e.poll.timeLoad?null:o.a.createElement(H.a,{span:12},"S\u1ed1 l\u01b0\u1ee3ng phi\u1ebfu b\u1ea7u t\u1ed1i \u0111a 2:"),0===e.poll.timeLoad?null:o.a.createElement(H.a,{span:12},e.poll.maxVoteOfPoll,"\xa0L\u1ea7n"),0===e.poll.timeLoad?null:o.a.createElement(H.a,{span:12},"Th\u1eddi gian \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp l\u1ea1i s\u1ed1 phi\u1ebfu:"),0===e.poll.timeLoad?null:o.a.createElement(H.a,{span:12},o.a.createElement("span",{style:{marginRight:"18px"}},Math.floor(e.poll.timeLoad/24),"\xa0Days"),o.a.createElement("span",null,e.poll.timeLoad%24,"\xa0Hours")),o.a.createElement(H.a,{span:12},"Ch\u1ebf \u0111\u1ed9 hi\u1ec3n th\u1ecb k\u1ebft qu\u1ea3:"),o.a.createElement(H.a,{span:12},1===e.poll.showResultCase?"\u0110\u01b0\u1ee3c xem ngay":null,2===e.poll.showResultCase?"Sau khi k\u1ebft th\xfac":null,3===e.poll.showResultCase?"Sau khi b\u1ea7u":null,4===e.poll.showResultCase?"Kh\xf4ng \u0111\u01b0\u1ee3c xem":null)),!e.poll.isExpired&&e.isOwner?o.a.createElement(D.a,{onClick:function(t){return e.onEndPoll(t,e.postIndex,e.pollIndex)},block:!0,danger:!0},"K\u1ebft th\xfac b\u1ea7u ch\u1ecdn"):null)}function we(e){return o.a.createElement("div",{className:"poll-content"},o.a.createElement("div",{className:"poll-header"},o.a.createElement("div",{className:"text-number"},e.pollIndex+1,"."),o.a.createElement(K.a,{placement:"right",title:"Infomation",content:o.a.createElement(Se,{poll:e.poll,onEndPoll:e.onEndPoll,isOwner:e.isOwner,pollIndex:e.pollIndex,postIndex:e.postIndex}),trigger:"click"},o.a.createElement(D.a,{type:"text",shape:"circle",className:"poll-info",icon:o.a.createElement(ce.a,null)})),o.a.createElement("div",{className:"poll-question"},e.poll.question),null!==e.poll.photo&&""!==e.poll.photo&&o.a.createElement(Q.a,{src:"https://drive.google.com/uc?export=view&id="+e.poll.photo})),o.a.createElement("div",{className:"poll-choices"},o.a.createElement(ve,{className:"poll-choice-radio-group",onChange:function(t){return e.handleVoteChange(t,e.pollIndex,e.postIndex)},value:e.currentVote[e.pollIndex]},e.pollChoices),e.choiceCanAdd?null:o.a.createElement(ee.a,null,o.a.createElement(ge,{validateStatus:e.choiceNew.validateStatus,help:e.choiceNew.errorMsg},e.choiceAdd))),o.a.createElement("div",{className:"poll-footer"},e.poll.selectedChoice||e.poll.isExpired?null:o.a.createElement(D.a,{className:"vote-button",disabled:!e.currentVote[e.pollIndex],onClick:function(t){return e.handleVoteSubmit(t,e.pollIndex,e.postIndex)}},"Vote"),o.a.createElement("span",{className:"total-votes"},e.poll.totalVotes," votes"),o.a.createElement("span",{className:"separator"},"\u2022"),o.a.createElement("span",{className:"time-left"},e.poll.isExpired?"Final results":e.getTimeRemaining(e.poll)),null!=e.currentUser&&e.choiceCanAdd&&(e.poll.isAddChoice||e.createdBy.username===e.currentUser.username)&&!e.poll.isExpired&&o.a.createElement(D.a,{type:"dashed",style:{float:"right"},onClick:function(){return e.addChoiceInput(e.postIndex,e.pollIndex)},icon:o.a.createElement(he.a,null),disabled:!e.choiceCanAdd},window.screen.width>768&&"Add a choice"),!e.choiceCanAdd&&o.a.createElement(D.a,{type:"dashed",style:{float:"right"},onClick:function(t){return e.addAChoice(t,e.postIndex,e.pollIndex)},disabled:e.choiceCanAdd},o.a.createElement(he.a,null)," Submit")))}function Pe(e){var t=Math.round(100*e.percentVote)/100;return o.a.createElement(K.a,{placement:"right",mouseEnterDelay:.5,content:o.a.createElement("div",{style:{maxWidth:"500px",minWidth:"400px"}},null!=e.choice.choicePrime&&null!=e.choice.choicePrime.photo&&""!==e.choice.choicePrime.photo?o.a.createElement(Q.a,{src:"https://drive.google.com/uc?export=view&id="+e.choice.choicePrime.photo}):null,null!=e.choice.choicePrime?o.a.createElement("div",{style:{wordBreak:"break-word"}},e.choice.choicePrime.review):null),title:o.a.createElement(o.a.Fragment,null,e.choice.text,e.isUnseenUserForAddChoice?null:o.a.createElement("span",{className:"separator"},"\u2022"),e.isUnseenUserForAddChoice?null:o.a.createElement(ae.b,{className:"creator-link",to:"/users/".concat(e.choice.createdBy.username)},e.choice.createdBy.name))},o.a.createElement("div",{className:"cv-poll-choice"},o.a.createElement("span",{className:"cv-poll-choice-details"},o.a.createElement("span",{className:"cv-choice-percentage"},e.isUnseenUserForVote?t+"%":o.a.createElement(D.a,{value:e.choice.id,style:{fontWeight:600},onClick:e.handleClickShowListVoted,type:"text"},Math.round(100*e.percentVote)/100,"%")),o.a.createElement("span",{className:"cv-choice-text"},e.choice.text)),o.a.createElement("span",{className:e.isWinner?"cv-choice-percent-chart winner":"cv-choice-percent-chart",style:{width:e.percentVote+"%"}})))}function ke(e){var t=Math.round(100*e.percentVote)/100;return o.a.createElement(K.a,{placement:"right",mouseEnterDelay:1,content:o.a.createElement("div",{style:{maxWidth:"500px",minWidth:"400px"}},null!=e.choice.choicePrime&&null!=e.choice.choicePrime.photo&&""!==e.choice.choicePrime.photo?o.a.createElement(Q.a,{src:"https://drive.google.com/uc?export=view&id="+e.choice.choicePrime.photo}):null,null!=e.choice.choicePrime?o.a.createElement("div",{style:{wordBreak:"break-word"}},e.choice.choicePrime.review):null),title:o.a.createElement(o.a.Fragment,null,e.choice.text,e.isUnseenUserForAddChoice?null:o.a.createElement("span",{className:"separator"},"\u2022"),e.isUnseenUserForAddChoice?null:o.a.createElement(ae.b,{className:"creator-link",to:"/users/".concat(e.choice.createdBy.username)},e.choice.createdBy.name))},o.a.createElement(z.a,{count:e.choice.userVoteCount,offset:[-0,0],className:"site-badge-count-4"},o.a.createElement(Z.a,{className:"poll-choice-radio",key:e.choice.id,value:e.choice.id},o.a.createElement("span",{className:"cv-poll-choice-details2"},o.a.createElement("span",{className:"cv-choice-percentage"},e.isUnseenUserForVote&&!e.isOwner?t+"%":o.a.createElement(D.a,{value:e.choice.id,style:{fontWeight:600},onClick:e.handleClickShowListVoted,type:"text"},Math.round(100*e.percentVote)/100,"%")),o.a.createElement("span",{className:"cv-choice-text"},e.choice.text)),o.a.createElement("span",{className:e.isSelected?"cv-choice-percent-chart2 winner":"cv-choice-percent-chart2",style:{width:e.percentVote+"%"}}),e.isDelete&&o.a.createElement(J.a,{title:"Choice Delete",placement:"top",arrowPointAtCenter:!0},o.a.createElement(D.a,{type:"dashed",icon:o.a.createElement(ie.a,null),shape:"circle",value:e.choice.id,onClick:e.handleClickDelChoice,size:"small",className:"delete-button-choice",style:{float:"right",marginRight:10}})),e.isSelected&&e.canFix&&o.a.createElement(J.a,{title:"Vote Delete",placement:"top",arrowPointAtCenter:!0},o.a.createElement(D.a,{type:"dashed",icon:o.a.createElement(re.a,null),shape:"circle",value:e.choice.id,onClick:e.handleClick,size:"small",className:"delete-button",style:{float:"right",marginRight:3}})))))}var xe=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).calculatePercentage=function(e,t){return 0===n.props.post.polls[t].totalVotes?0:100*e.voteCount/n.props.post.polls[t].totalVotes},n.isSelected=function(e,t){return n.props.post.polls[e].choices[t].userVoteCount>0},n.getWinningChoice=function(e){return n.props.post.polls[e].choices.reduce((function(e,t){return t.voteCount>e.voteCount?t:e}),{voteCount:-1/0})},n.getTimeRemaining=function(e){if(null==e.expirationDateTime)return"No limit";var t=new Date(e.expirationDateTime).getTime()-(new Date).getTime(),a=Math.floor(t/1e3%60),n=Math.floor(t/1e3/60%60),o=Math.floor(t/36e5%24),s=Math.floor(t/864e5);return s>0?s+" days left":o>0?o+" hours left":n>0?n+" minutes left":a>0?a+" seconds left":"less than a second left"},n.onChange=function(e,t){var a=n.state.choiceNew.slice();a[t]=Object.assign(a[t],Object(R.a)({text:e.target.value},n.validateChoice(e.target.value))),n.setState({choiceNew:a})},n.validateChoice=function(e){return 0===e.length?{validateStatus:"error",errorMsg:"Please enter a choice!"}:e.length>40?{validateStatus:"error",errorMsg:"Choice is too long (Maximum ".concat(40," characters allowed)")}:{validateStatus:"success",errorMsg:null}},n.onReviewChange=function(e,t){var a=n.state.choiceNew.slice();a[t]=Object.assign(a[t],Object(R.a)({review:e.target.value},n.validateChoice(a[t].text))),n.setState({choiceNew:a})},n.onImageChoiceChange=function(e,t){if(e.file.status,0===e.fileList.length){var a=n.state.choiceNew.slice();a[t].photo=null,n.setState({choiceNew:a})}if("done"===e.file.status){var o=n.state.choiceNew.slice();o[t].photo=e.fileList[0].response.id,n.setState({choiceNew:o}),l.a.success({message:"Polling App",description:"".concat(e.file.name," file uploaded successfully")})}else"error"===e.file.status&&(null!=e.file.response?l.a.error({message:"Polling App",description:"".concat(e.file.response.message)}):l.a.error({message:"Polling App",description:"".concat(e.file.name," file upload failed. Max file size is 20MB")}))},n.addAChoice=function(e,t,a){n.props.addAChoice(e,t,a,n.state.choiceNew[a]);var o=n.state.choiceCanAdd.slice();o[a]=!0;var s=n.state.choiceNew.slice();s[a]={text:"",review:"",photo:null},n.setState({choiceCanAdd:o,choiceNew:s})},n.removeAddChoice=function(e){var t=n.state.choiceAdd.slice();t[e]=null;var a=n.state.choiceCanAdd.slice();a[e]=!0;var o=n.state.choiceNew.slice();o[e]={text:"",review:"",photo:null},n.setState({choiceAdd:t,choiceCanAdd:a,choiceNew:o})},n.addChoiceInput=function(e,t){var a=n.state.choiceAdd.slice();a[t]=o.a.createElement("div",null,o.a.createElement(te.a,{placeholder:"Choice ",size:"large",defaultValue:n.state.choiceNew[t].text,className:"optional-choice",onPressEnter:function(a){return n.addAChoice(a,e,t)},onChange:function(e){return n.onChange(e,t)}}),o.a.createElement(re.a,{className:"dynamic-delete-button",onClick:function(){return n.removeAddChoice(t)}}),o.a.createElement(pe,{placeholder:"Review",size:"large",defaultValue:n.state.choiceNew[t].review,className:"optional-textchoice2",onChange:function(e){return n.onReviewChange(e,t)},onPressEnter:function(a){return n.addAChoice(a,e,t)}}),o.a.createElement(X.a,Object.assign({},fe,{listType:"picture",className:"upload-inline",maxCount:1,onChange:function(e){return n.onImageChoiceChange(e,t)}}),null==n.state.choiceNew[t].photo?o.a.createElement(D.a,{className:"button-upload2",icon:o.a.createElement(le.a,null)},"Upload"):o.a.createElement(D.a,{className:"button-upload",disabled:!0,icon:o.a.createElement(le.a,null)},"Upload")));var s=n.state.choiceCanAdd.slice();s[t]=!1,n.setState({choiceAdd:a,choiceCanAdd:s})},n.handleChangeComment=function(e){n.props.handleChangeComment(e,n.props.postIndex)},n.handleSubmitComment=function(){n.props.handleSubmitComment(n.props.postIndex)},n.onComment=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;n.props.onComment(e,t,n.props.post.id,n.props.postIndex)},n.onReply=function(e){n.props.onReply(n.props.postIndex,e)},n.handleChangeReply=function(e){n.props.handleChangeReply(e,n.props.postIndex)},n.handleSubmitReply=function(e){n.props.handleSubmitReply(n.props.postIndex,e)},n.onClickUpdateName=function(){n.setState({isUpdateName:!n.state.isUpdateName})},n.onChangeName=function(e){n.setState({valueName:e.target.value})},n.updateName=function(){n.setState({isUpdateName:!n.state.isUpdateName}),n.props.updateName(n.state.valueName,n.props.postIndex)},n.state={choiceAdd:Array(n.props.post.polls.length).fill(null),choiceCanAdd:Array(n.props.post.polls.length).fill(!0),choiceNew:Array(n.props.post.polls.length).fill({text:"",photo:null,review:""}),isUpdateName:!1,valueName:""},n}return Object(T.a)(a,[{key:"componentDidMount",value:function(){this.setState({valueName:this.props.post.question})}},{key:"render",value:function(){var e=this,t=this.props,a=t.comments,n=t.submittingComment,s=t.valueComment,r=t.showReply,l=[],i=this.props.showComment&&a.length>0&&!this.props.isLastComment&&o.a.createElement(ae.b,{to:"#",onClick:function(){return e.props.onLoadMoreComment(e.props.pageComment+1,h,e.props.post.id,e.props.postIndex)}},"Load More...");l.push(o.a.createElement(M.b,{key:1,dataSource:a,loadMore:i,itemLayout:"horizontal",renderItem:function(t,a){return o.a.createElement(M.b.Item,{key:a,style:{display:"block"}},o.a.createElement($.a,{actions:null==e.props.currentUser||t.user.username!==e.props.currentUser.username&&e.props.post.createdBy.username!==e.props.currentUser.username?[o.a.createElement("span",{key:"comment-nested-reply-to",onClick:function(){return e.onReply(a)}},"Reply to")]:[o.a.createElement("span",{key:"comment-nested-reply-to",onClick:function(){return e.onReply(a)}},"Reply to"),o.a.createElement("span",{key:"delete-comment",onClick:function(){return e.props.onDeleteComment(e.props.postIndex,a)}},"Delete")],author:o.a.createElement(ae.b,{to:"/users/".concat(t.user.username)},t.user.name),avatar:null==t.user.photo?o.a.createElement(ae.b,{to:"/users/".concat(t.user.username)},o.a.createElement(O.a,{style:{backgroundColor:oe(t.user.name)}},t.user.name[0].toUpperCase())):o.a.createElement(ae.b,{to:"/users/".concat(t.user.username)},o.a.createElement(O.a,{src:"https://drive.google.com/uc?export=view&id="+t.user.photo})),content:o.a.createElement("p",null,t.text),datetime:Ce(t.createDate)},null!==t.replys&&0!==t.replys.length&&o.a.createElement(M.b,{rowKey:function(e){return e.id},dataSource:t.replys,itemLayout:"horizontal",renderItem:function(t,n){return o.a.createElement(M.b.Item,{key:n},o.a.createElement($.a,{actions:null!=e.props.currentUser&&(t.user.username===e.props.currentUser.username||e.props.post.createdBy.username===e.props.currentUser.username)&&[o.a.createElement("span",{key:"delete-reply",onClick:function(){return e.props.onDeleteReply(e.props.postIndex,a,n)}},"Delete")],author:o.a.createElement(ae.b,{to:"/users/".concat(t.user.username)},t.user.name),avatar:null==t.user.photo?o.a.createElement(ae.b,{to:"/users/".concat(t.user.username)},o.a.createElement(O.a,{style:{backgroundColor:oe(t.user.name)}},t.user.name[0].toUpperCase())):o.a.createElement(ae.b,{to:"/users/".concat(t.user.username)},o.a.createElement(O.a,{src:"https://drive.google.com/uc?export=view&id="+t.user.photo})),content:o.a.createElement("p",null,t.text),datetime:Ce(t.createDate)}))}})),r[a]&&null!=e.props.currentUser&&o.a.createElement($.a,{avatar:null==e.props.currentUser.photo?o.a.createElement(O.a,{style:{backgroundColor:oe(e.props.currentUser.name)}},e.props.currentUser.name[0].toUpperCase()):o.a.createElement(O.a,{src:"https://drive.google.com/uc?export=view&id="+e.props.currentUser.photo}),content:o.a.createElement(Ee,{onChange:e.handleChangeReply,onSubmit:function(){return e.handleSubmitReply(a)},submitting:e.props.submittingReply[a],value:e.props.valueReply,textButton:"Reply"})}))}}));var c=[];this.props.post.polls.forEach((function(t,a){var n=[];if(t.isExpired||t.totalUserVotes===t.maxVotePerTimeLoad&&3===t.showResultCase&&!t.isCanFix){var s=e.props.post.polls[a].expired?e.getWinningChoice(a):null;t.choices.forEach((function(r,l){n.push(o.a.createElement(Pe,{isUnseenUserForAddChoice:t.isUnseenUserForAddChoice,key:r.id,choice:r,isWinner:s&&r.id===s.id,handleClickShowListVoted:function(){return e.props.handleShowListVoted(r.id,0,5)},isSelected:e.isSelected(a,l),percentVote:e.calculatePercentage(r,a)}))}))}else 1===t.showResultCase||0!==t.totalUserVotes&&3===t.showResultCase&&!t.isCanFix?t.choices.forEach((function(s,r){n.push(o.a.createElement(ke,{key:s.id,choice:s,isUnseenUserForVote:t.isUnseenUserForVote,isUnseenUserForAddChoice:t.isUnseenUserForAddChoice,isSelected:e.isSelected(a,r),percentVote:e.calculatePercentage(s,a),handleClickShowListVoted:function(){return e.props.handleShowListVoted(s.id)},handleClick:function(t){return e.props.handleDeleteVoteSubmit(t,e.props.postIndex,a)},handleClickDelChoice:function(t){return e.props.handleDeleteChoiceSubmit(t,e.props.postIndex,a)},isDelete:null!=e.props.currentUser&&(e.props.currentUser.username===e.props.post.createdBy.username||e.props.currentUser.username===s.createdBy.username)&&!t.isExpired,isOwner:null!=e.props.currentUser&&e.props.currentUser.username===e.props.post.createdBy.username,canFix:t.isCanFix}))})):1!==t.showResultCase&&t.choices.forEach((function(s,r){n.push(o.a.createElement(K.a,{placement:"right",key:s.id,mouseEnterDelay:1,content:o.a.createElement("div",{style:{maxWidth:"500px",minWidth:"400px"}},null!=s.choicePrime&&null!=s.choicePrime.photo&&""!==s.choicePrime.photo?o.a.createElement(Q.a,{src:"https://drive.google.com/uc?export=view&id="+s.choicePrime.photo}):null,null!=s.choicePrime?o.a.createElement("div",{style:{wordBreak:"break-word"}},s.choicePrime.review):null),title:o.a.createElement(o.a.Fragment,null,s.text,t.isUnseenUserForAddChoice?null:o.a.createElement("span",{className:"separator"},"\u2022"),t.isUnseenUserForAddChoice?null:o.a.createElement(ae.b,{className:"creator-link",to:"/users/".concat(s.createdBy.username)},s.createdBy.name))},o.a.createElement("div",null,o.a.createElement(Z.a,{className:"poll-choice-radio",key:s.id,value:s.id},o.a.createElement("span",{style:{paddingLeft:"20px"}},s.text,e.props.isAuthenticated&&e.props.currentUser.username===e.props.post.createdBy.username&&!t.isExpired&&o.a.createElement(J.a,{title:"Choice Delete",placement:"top",arrowPointAtCenter:!0},o.a.createElement(D.a,{type:"dashed",icon:o.a.createElement(ie.a,null),shape:"circle",value:s.id,onClick:function(t){return e.props.handleDeleteChoiceSubmit(t,e.props.postIndex,a)},size:"small",className:"delete-button-choice",style:{float:"right",marginRight:10}})),e.isSelected(a,r)&&t.isCanFix&&o.a.createElement(J.a,{title:"Vote Delete",placement:"top",arrowPointAtCenter:!0},o.a.createElement(D.a,{type:"dashed",icon:o.a.createElement(re.a,null),shape:"circle",value:s.id,onClick:function(t){return e.props.handleDeleteVoteSubmit(t,e.props.postIndex,a)},size:"small",className:"delete-button",style:{float:"right",marginRight:3}})))))))}));c.push(o.a.createElement(we,{key:a,postIndex:e.props.postIndex,choiceAdd:e.state.choiceAdd[a],poll:t,pollIndex:a,pollChoices:n,choiceCanAdd:e.state.choiceCanAdd[a],choiceNew:e.state.choiceNew[a],handleVoteChange:e.props.handleVoteChange,currentVote:e.props.currentVote,addChoiceInput:e.addChoiceInput,createdBy:e.props.post.createdBy,creationDateTime:e.props.post.creationDateTime,addAChoice:e.addAChoice,getTimeRemaining:e.getTimeRemaining,handleVoteSubmit:e.props.handleVoteSubmit,currentUser:e.props.currentUser,isOwner:null!=e.props.currentUser&&e.props.currentUser.username===e.props.post.createdBy.username,onEndPoll:e.props.onEndPoll}))}));var u=function(e){if(null==e)return"";var t=new Date(e).getTime()-(new Date).getTime(),a=Math.floor(t/1e3%60),n=Math.floor(t/1e3/60%60),o=Math.floor(t/36e5%24),s=Math.floor(t/864e5);return s>0?"C\xf2n "+s+" ng\xe0y":o>0?"C\xf2n "+o+" gi\u1edd":n>0?"C\xf2n "+n+" ph\xfat":a>0?"C\xf2n "+a+" gi\xe2y":""}(this.props.post.publicDate);return o.a.createElement(o.a.Fragment,null,o.a.createElement(q.a,{style:{marginBottom:30},className:"poll-content"},o.a.createElement("div",{className:"poll-header"},o.a.createElement(K.a,{placement:"right",title:"T\xf9y ch\u1ecdn",content:o.a.createElement(ye,{isUserStorage:this.props.post.isUserStorage,isOwner:null!=this.props.currentUser&&this.props.currentUser.username===this.props.post.createdBy.username,onUpdatePost:this.onClickUpdateName,onDeletePost:this.props.onDeletePost,deleteFollowPost:this.props.deleteFollowPost,onFollowPost:this.props.onFollowPost,postIndex:this.props.postIndex}),trigger:"click"},o.a.createElement(D.a,{type:"text",shape:"circle",className:"poll-info",icon:o.a.createElement(ce.a,null)})),o.a.createElement("div",{className:"poll-creator-info"},o.a.createElement(ae.b,{className:"creator-link",to:"/users/".concat(this.props.post.createdBy.username)},null==this.props.post.createdBy.photo?o.a.createElement(O.a,{className:"poll-creator-avatar",style:{backgroundColor:oe(this.props.post.createdBy.name)}},this.props.post.createdBy.name[0].toUpperCase()):o.a.createElement(O.a,{className:"poll-creator-avatar",src:"https://drive.google.com/uc?export=view&id="+this.props.post.createdBy.photo}),o.a.createElement("span",{className:"poll-creator-name"},this.props.post.createdBy.name),o.a.createElement("span",{className:"poll-creator-username"},"@",this.props.post.createdBy.username),""!==u&&o.a.createElement("span",{className:"separator"},"\u2022"),""!==u&&o.a.createElement("span",null,u)),o.a.createElement(ae.b,{to:"/post/"+this.props.post.id},o.a.createElement("span",{className:"poll-creation-date"},Ce(this.props.post.polls[0].creationDateTime))),o.a.createElement("span",{className:"separator"},"\u2022"),o.a.createElement("span",{className:"poll-creation-date"},1===this.props.post.showCase?"B\xed m\u1eadt":null,2===this.props.post.showCase?"Ri\xeang t\u01b0":null,3===this.props.post.showCase?"C\xf4ng khai":null,4===this.props.post.showCase?"Gi\u1edbi h\u1ea1n ng\u01b0\u1eddi":null,5===this.props.post.showCase?o.a.createElement(K.a,{placement:"right",id:"grouplist",title:"Danh s\xe1ch nh\xf3m",content:o.a.createElement(be,{list:this.props.post.groupResponses}),trigger:"click"},o.a.createElement(D.a,{type:"text",className:"poll-show-case-button"},"Nh\xf3m")):null)),o.a.createElement("div",{className:"poll-question"},this.state.isUpdateName?o.a.createElement(pe,{value:this.state.valueName,onChange:this.onChangeName}):o.a.createElement(o.a.Fragment,null,this.props.post.question)),this.state.isUpdateName&&o.a.createElement(D.a,{style:{marginBottom:15},onClick:this.updateName},"Update"),c),o.a.createElement("ul",{className:"ant-card-actions"},o.a.createElement("li",{style:{width:"50%",cursor:"pointer"}},o.a.createElement("div",{onClick:function(){return e.props.onLikePost(e.props.postIndex)}},this.props.post.isUserLike?o.a.createElement(ue.a,{twoToneColor:"#eb2f96"}):o.a.createElement(me.a,{key:"like"}),null!=this.props.post.totalLike?o.a.createElement("span",{className:"separator"},"\u2022"):null,this.props.post.totalLike)),o.a.createElement("li",{style:{width:"50%",cursor:"pointer"}},o.a.createElement("div",{onClick:function(t){return e.onComment()}},o.a.createElement(de.a,{key:"comment"}),null!=this.props.post.totalComment?o.a.createElement("span",{className:"separator"},"\u2022"):null,this.props.post.totalComment))),this.props.showComment&&o.a.createElement(W.a,{style:{margin:"0"}}),this.props.showComment&&null!=this.props.currentUser&&o.a.createElement($.a,{avatar:null==this.props.currentUser.photo?o.a.createElement(O.a,{style:{backgroundColor:oe(this.props.currentUser.name)}},this.props.currentUser.name[0].toUpperCase()):o.a.createElement(O.a,{src:"https://drive.google.com/uc?export=view&id="+this.props.currentUser.photo}),content:o.a.createElement(Ee,{onChange:this.handleChangeComment,onSubmit:this.handleSubmitComment,submitting:n,value:s,textButton:"Comment"})}),this.props.showComment&&a.length>0&&l))}}]),a}(n.Component),Ne=(a(147),a(98)),Ue=a(447);function Ae(e){var t=o.a.createElement(Ue.a,{style:{fontSize:30},spin:!0});return o.a.createElement(Ne.a,{indicator:t,style:{display:"block",textAlign:"center",marginTop:30}})}var Ie=a(261),Le=(a(378),a(172)),Me=a.n(Le),Oe=a(173),Ve=a.n(Oe),De=a(174),Re=a.n(De),je=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.addAChoice=function(e,t,a,o){if(e.preventDefault(),!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to add Choice."});var s=n.state.posts[t].polls[a].id;(function(e,t){return v({url:m+"/polls/"+t+"/addchoice",method:"POST",body:JSON.stringify(e)})})({text:o.text,review:o.review,photo:o.photo},s).then((function(e){var a=n.state.posts.slice();a[t]=e,n._isMounted&&n.setState({posts:a})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.handleChangeComment=function(e,t){var a=n.state.valueComment;a[t]=e.target.value,n.setState({valueComment:a})},n.handleSubmitComment=function(e){if(n.state.valueComment[e]){if(!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to comment."});var t,a,o=n.state.submittingComment;o[e]=!0,n.setState({submittingComment:o}),(t=n.state.posts[e].id,a=n.state.valueComment[e],v({url:m+"/polls/"+t+"/comment?text="+a,method:"POST"})).then((function(t){var a=n.state.comments.slice();a[e]=a[e].concat(t);var o=n.state.posts.slice();o[e].totalComment++;var s=n.state.valueComment.slice();s[e]="",n.setState({comments:a,valueComment:s,posts:o})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),o[e]=!1,n.setState({submittingComment:o})}},n.onComment=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;n.state.showComment[o]||n.onLoadMoreComment(e,t,a,o);var s=n.state.showComment.slice();s[o]=!s[o],n.setState({showComment:s})},n.onLoadMoreComment=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;n.state.pageComment[o]===e?P(a,e,t).then((function(e){var t=e.content,a=n.state.comments.slice();a[o]=t;var s=n.state.showReply.slice();s[o]=Array(t.length).fill(!1);var r=n.state.submittingReply.slice();r[o]=Array(t.length).fill(!1);var l=n.state.pageComment.slice();l[o]=e.page;var i=n.state.isLastComment.slice();i[o]=e.last,n.setState({comments:a,showReply:s,submittingReply:r,pageComment:l,isLastComment:i})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})):P(a,e,t).then((function(e){var t=n.state.comments[o].slice().concat(e.content),a=n.state.comments.slice();a[o]=t;var s=n.state.showReply.slice();s[o]=Array(t.length).fill(!1);var r=n.state.submittingReply.slice();r[o]=Array(t.length).fill(!1);var l=n.state.pageComment.slice();l[o]=e.page;var i=n.state.isLastComment.slice();i[o]=e.last,n.setState({comments:a,showReply:s,submittingReply:r,pageComment:l,isLastComment:i})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.onReply=function(e,t){var a=n.state.showReply;a[e][t]=!a[e][t],n.setState({showReply:a})},n.handleChangeReply=function(e,t){var a=n.state.valueReply.splice();a[t]=e.target.value,n.setState({valueReply:a})},n.handleSubmitReply=function(e,t){if(n.state.valueReply[e]){if(!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to reply."});var a,o,s,r=n.state.submittingReply;r[e][t]=!0,n.setState({submittingReply:r}),(a=n.state.posts[e].id,o=n.state.comments[e][t].id,s=n.state.valueReply[e],v({url:m+"/polls/"+a+"/comment/"+o+"?text="+s,method:"POST"})).then((function(a){var o=n.state.comments.slice()[e];o.some((function(e,t){return e.id===a.commentId&&(o[t].replys=o[t].replys.concat(a)),e.id===a.commentId}));var s=n.state.comments;s[e]=o;var r=n.state.submittingReply;r[e][t]=!1;var l=n.state.valueReply;l[e]=!1,n.setState({comments:s,submittingReply:r,valueReply:l})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},n.loadPostList=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;switch(n._isMounted&&n.setState({isLoading:!0}),n.props.type){case"GROUP":e=b(n.props.match.params.code,t,a);break;case"ONE_POST":e=y(n.props.match.params.id);break;case"USER_CREATED_POSTS":e=N(n.props.username,t,a);break;case"USER_VOTED_POSTS":e=U(n.props.username,t,a);break;case"SEARCH_POST":e=E(n.props.match.params.search,t,a);break;case"USER_SAVE_POSTS":e=A(t,a);break;default:e=C(t,a)}e&&e.then((function(e){var t=n.state.posts.slice(),a=n.state.currentVotes.slice().concat(Array(e.content.length).fill(null)),o=n.state.comments.slice().concat(Array(e.content.length).fill([])),s=n.state.submittingComment.slice().concat(Array(e.content.length).fill(!1)),r=n.state.valueComment.slice().concat(Array(e.content.length).fill("")),l=n.state.showComment.slice().concat(Array(e.content.length).fill(!1)),i=n.state.showReply.slice().concat(Array(e.content.length).fill([])),c=n.state.valueReply.slice().concat(Array(e.content.length).fill("")),u=n.state.submittingReply.slice().concat(Array(e.content.length).fill([])),m=n.state.pageComment.slice().concat(Array(e.content.length).fill(0)),d=n.state.isLastComment.slice().concat(Array(e.content.length).fill(!1));e.content.forEach((function(e,n){a[t.length+n]=Array(e.polls.length).fill(null)})),t.concat(e.content),n.state.page===e.page&&0===n.state.check?n._isMounted&&n.setState({posts:t.concat(e.content),page:e.page,size:e.size,totalElements:e.totalElements,totalPages:e.totalPages,last:e.last,currentVotes:a,isLoading:!1,check:1,comments:o,submittingComment:s,valueComment:r,showComment:l,showReply:i,valueReply:c,submittingReply:u,pageComment:m,isLastComment:d}):n.state.page!==e.page&&n._isMounted&&n.setState({posts:t.concat(e.content),page:e.page,size:e.size,totalElements:e.totalElements,totalPages:e.totalPages,last:e.last,currentVotes:a,isLoading:!1,check:0,comments:o,submittingComment:s,valueComment:r,showComment:l,showReply:i,valueReply:c,submittingReply:u,pageComment:m})})).catch((function(e){n._isMounted&&n.setState({isLoading:!1})}))},n.socketPoll=function(e){var t=n.state.posts.slice();switch(e.type){case 1:t.some((function(a,n){return a.id===e.postId&&a.polls.some((function(a,o){return a.id===e.pollId&&(t[n].polls[o].totalVotes=e.totalVotes,e.choices.forEach((function(e){a.choices.some((function(a,s){return a.id===e.id&&(e.userVoteCount=a.userVoteCount,t[n].polls[o].choices[s]=Object(R.a)(Object(R.a)({},t[n].polls[o].choices[s]),e)),a.id===e.id}))}))),a.id===e.pollId})),a.id===e.postId}));break;case 2:t.some((function(a,n){return a.id===e.postId&&a.polls.some((function(a,o){return a.id===e.pollId&&(t[n].polls[o].isExpired=e.isExpired,t[n].polls[o].expirationDateTime=e.expirationDateTime),a.id===e.pollId})),a.id===e.postId}));break;case 3:t.some((function(a,n){return a.id===e.postId&&a.polls.some((function(a,o){return a.id===e.pollId&&(t[n].polls[o].choices=t[n].polls[o].choices.concat(e.choices[0])),a.id===e.pollId})),a.id===e.postId}));break;case 4:t.some((function(a,n){return a.id===e.postId&&a.polls.some((function(a,o){return a.id===e.pollId&&a.choices.some((function(a,s){return a.id===e.choiceId&&(t[n].polls[o].totalVotes=t[n].polls[o].totalVotes-t[n].polls[o].choices[s].voteCount,t[n].polls[o].choices.splice(s,1)),a.id===e.choiceId})),a.id===e.pollId})),a.id===e.postId}));break;case 5:t.some((function(a,n){return a.id===e.postId&&t[n].totalLike++,a.id===e.postId}));break;case 6:t.some((function(a,n){return a.id===e.postId&&t[n].totalLike--,a.id===e.postId}));break;case 7:t.some((function(a,o){if(a.id===e.postId&&(t[o].totalComment++,n.state.showComment[o])){var s=n.state.comments.slice();s[o]=s[o].concat(e.comment),n.setState({comments:s})}return a.id===e.postId}));break;case 8:t.some((function(t,a){if(t.id===e.postId&&n.state.showComment[a]){var o=n.state.comments.slice();o[a].some((function(t,s){return t.id===e.reply.commentId&&(o[a][s].replys=o[a][s].replys.concat(e.reply),n.setState({comments:o})),t.id===e.reply.commentId}))}return t.id===e.postId}));break;case 9:t.some((function(a,n){return a.id===e.postId&&(t[n].question=e.name),a.id===e.postId}));break;case 10:l.a.info({message:"Notification",description:e.name,placement:"bottomLeft",onClick:function(){return n.props.history.push("/post/"+e.postId)}})}n._isMounted&&n.setState({posts:t})},n.onFollowPost=function(e){var t,a=n.state.posts;if(!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to follow."});(t=a[e].id,v({url:m+"/polls/"+t+"/save",method:"POST"})).then((function(t){a[e].isUserStorage=!0,n.setState({posts:a}),l.a.success({message:"Polling App",description:t.message||"Sorry! Something went wrong. Please try again!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.deleteFollowPost=function(e){var t,a=n.state.posts;if(!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to follow."});(t=a[e].id,v({url:m+"/polls/"+t+"/save",method:"DELETE"})).then((function(t){a[e].isUserStorage=!1,n.setState({posts:a}),l.a.success({message:"Polling App",description:t.message||"Sorry! Something went wrong. Please try again!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.onLikePost=function(e){var t,a=n.state.posts[e];if(!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to like."});(t=a.id,v({url:m+"/polls/"+t+"/like",method:"POST"})).then((function(t){var a=n.state.posts.slice();a[e]=t,n._isMounted&&n.setState({posts:a})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.showModalDeletePost=function(e){n._isMounted&&n.setState({visiblePost:!0,currentPostIndex:e})},n.handleDeletePostSubmit=function(){var e,t=n.state.posts[n.state.currentPostIndex];if(!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to delete."});(e=t.id,v({url:m+"/polls/"+e,method:"DELETE"})).then((function(e){var t=n.state.posts.slice();t.splice(n.state.currentPostIndex,1),n._isMounted&&n.setState({posts:t}),l.a.success({message:"Polling App",description:e.message||"Successfully!!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),n._isMounted&&n.setState({visiblePost:!1})},n.handleLoadMore=function(e){n.loadPostList(e)},n.handleLoadMoreUserVoted=function(){n.loadListVoted(n.state.currentChoiceId,n.state.pageVoted+1)},n.handleCancel=function(){n._isMounted&&n.setState({visible:!1,currentPollIndex:0,currentPostIndex:0,currentValue:""})},n.handleCancelComment=function(){n._isMounted&&n.setState({visibleCommentDelete:!1,currentCommentIndex:0,currentPostIndex:0})},n.handleCancelReply=function(){n._isMounted&&n.setState({visibleReplyDelete:!1,currentCommentIndex:0,currentPostIndex:0,currentReplyIndex:0})},n.handleCancelPost=function(){n._isMounted&&n.setState({visiblePost:!1,currentPostIndex:0})},n.handleCancelListVoted=function(){n._isMounted&&n.setState({visibleListVoted:!1,votedUsers:[],isLoading2:!1,last2:!1})},n.loadListVoted=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;n._isMounted&&n.setState({isLoading2:!0}),w(e,t,a).then((function(a){var o=n.state.votedUsers.slice();!0!==n.state.last2&&n._isMounted&&n.setState({votedUsers:o.concat(a.content),currentChoiceId:e,pageVoted:t,last2:a.last,isLoading2:!1})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"}),n._isMounted&&n.setState({isLoading2:!1})}))},n.showModalListVoted=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;n._isMounted&&n.setState({visibleListVoted:!0}),n.loadListVoted(e,t,a)},n.showModal=function(e,t,a){n._isMounted&&n.setState({visible:!0,currentPollIndex:a,currentPostIndex:t,currentValue:e.currentTarget.value})},n.showModalComment=function(e,t){console.log(t),console.log(e),n._isMounted&&n.setState({visibleCommentDelete:!0,currentPostIndex:e,currentCommentIndex:t})},n.showModalReply=function(e,t,a){console.log(t),console.log(e),console.log(a),n._isMounted&&n.setState({visibleReplyDelete:!0,currentPostIndex:e,currentCommentIndex:t,currentReplyIndex:a})},n.handleDeleteVoteSubmit=function(e,t,a){if(e.preventDefault(),!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to delete."});var o,s,r=n.state.posts[t].polls[a],i={choiceId:e.currentTarget.value};(o=r.id,s=i,v({url:m+"/polls/"+o+"/deletevotes",method:"POST",body:JSON.stringify(s)})).then((function(e){var a=n.state.posts.slice();a[t]=e,n._isMounted&&n.setState({posts:a})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.onEndPoll=function(e,t,a){if(e.preventDefault(),!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to update."});var o,s=n.state.posts[t].polls[a];(o=s.id,v({url:m+"/polls/"+o+"/endpoll",method:"PUT"})).then((function(e){var a=n.state.posts.slice();a[t]=e,n._isMounted&&n.setState({posts:a})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.handleDeleteChoiceSubmit=function(e){if(e.preventDefault(),!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to delete."});var t,a,o=n.state.posts[n.state.currentPostIndex].polls[n.state.currentPollIndex],s={choiceId:n.state.currentValue};(t=o.id,a=s,v({url:m+"/polls/"+t+"/deletechoice",method:"POST",body:JSON.stringify(a)})).then((function(e){var t=n.state.posts.slice();t[n.state.currentPostIndex]=e,n._isMounted&&n.setState({posts:t})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),n._isMounted&&n.setState({visible:!1})},n.handleDeleteCommentSubmit=function(e){if(e.preventDefault(),!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to delete."});var t,a,o=n.state.currentPostIndex,s=n.state.currentCommentIndex,r=n.state.comments.slice(),i=n.state.posts.slice();(t=i[o].id,a=r[o][s].id,v({url:m+"/polls/"+t+"/comment/"+a,method:"DELETE"})).then((function(e){i[o].totalComment--,r[o].splice(s,1),n._isMounted&&n.setState({posts:i,comments:r}),l.a.success({message:"Polling App",description:e.message||"Delete comment success!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),n._isMounted&&n.setState({visibleCommentDelete:!1})},n.handleDeleteReplySubmit=function(e){if(e.preventDefault(),!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to delete."});var t,a,o,s=n.state.currentPostIndex,r=n.state.currentCommentIndex,i=n.state.currentReplyIndex,c=n.state.comments.slice(),u=n.state.posts.slice();(t=u[s].id,a=c[s][r].id,o=c[s][r].replys[i].id,v({url:m+"/polls/"+t+"/comment/"+a+"/reply/"+o,method:"DELETE"})).then((function(e){c[s][r].replys.splice(i,1),n._isMounted&&n.setState({comments:c}),l.a.success({message:"Polling App",description:e.message||"Delete comment success!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),n._isMounted&&n.setState({visibleReplyDelete:!1})},n.updateName=function(e,t){var a,o,s=n.state.posts;if(!n.props.isAuthenticated)return n.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to update."});(a=s[t].id,o=e,v({url:m+"/polls/"+a+"?name="+o,method:"PUT"})).then((function(a){l.a.success({message:"Polling App",description:"Thank you! You're successfully update post name!"}),s[t].question=e,n.setState({posts:s}),n.props.history.push("/post/"+s[t].id)})).catch((function(e){l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.state={posts:[],page:0,size:10,totalElements:0,totalPages:0,last:!1,currentVotes:[],isLoading:!1,visible:!1,currentPollIndex:0,currentPostIndex:0,currentValue:"",prevY:0,visibleListVoted:!1,votedUsers:[],pageVoted:0,currentChoiceId:0,isLoading2:!1,last2:!1,stompClient:null,check:0,visiblePost:!1,comments:[],submittingComment:[],valueComment:[],showComment:[],showReply:[],valueReply:[],submittingReply:[],pageComment:[],isLastComment:[],visibleCommentDelete:!1,currentCommentIndex:0,visibleReplyDelete:!1,currentReplyIndex:0},n.loadPostList=n.loadPostList.bind(Object(F.a)(n)),n.handleLoadMore=n.handleLoadMore.bind(Object(F.a)(n)),n.handleVoteChange=n.handleVoteChange.bind(Object(F.a)(n)),n.handleVoteSubmit=n.handleVoteSubmit.bind(Object(F.a)(n)),n}return Object(T.a)(a,[{key:"componentWillUnmount",value:function(){this._isMounted=!1,null!=this.state.stompClient&&(this.state.stompClient.send("/app/stop",{}),this.state.stompClient.disconnect())}},{key:"componentDidMount",value:function(){var e=this;if(this._isMounted=!0,this.props.isAuthenticated&&null==this.state.stompClient&&!0!==this.props.socket){var t=new Ve.a(m+"/ws"),a=Re.a.over(t),n={Authorization:"Bearer "+localStorage.getItem(d)};a.connect(n,(function(){a.subscribe("/user/queue/item",(function(t){return e.socketPoll(JSON.parse(t.body))}),n)})),this._isMounted&&this.setState({stompClient:a})}this.loadPostList(this.state.page)}},{key:"componentDidUpdate",value:function(e){this.props.isAuthenticated===e.isAuthenticated&&this.props.match.params.code===e.match.params.code||(this.setState({posts:[],page:0,size:10,totalElements:0,totalPages:0,last:!1,currentVotes:[],isLoading:!1,visible:!1,currentPollIndex:0,currentPostIndex:0,currentValue:"",prevY:0,visibleListVoted:!1,votedUsers:[],pageVoted:0,currentChoiceId:0,isLoading2:!1,last2:!1,check:0,visiblePost:!1}),this.loadPostList())}},{key:"handleVoteChange",value:function(e,t,a){var n=this.state.currentVotes.slice();n[a][t]=e.target.value,this._isMounted&&this.setState({currentVotes:n})}},{key:"handleVoteSubmit",value:function(e,t,a){var n=this;if(e.preventDefault(),!this.props.isAuthenticated)return this.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to vote."});var o=this.state.posts[a].polls[t],s=this.state.currentVotes[a][t];(function(e){return v({url:m+"/polls/"+e.pollId+"/votes",method:"POST",body:JSON.stringify(e)})})({pollId:o.id,choiceId:s}).then((function(e){var t=n.state.posts.slice();t[a]=e,n._isMounted&&n.setState({posts:t})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"render",value:function(){var e=this,t=[];return this.state.posts.forEach((function(a,n){t.push(o.a.createElement(xe,{onLoadMoreComment:e.onLoadMoreComment,onDeleteReply:e.showModalReply,onDeleteComment:e.showModalComment,showComment:e.state.showComment[n],comments:e.state.comments[n],pageComment:e.state.pageComment[n],isLastComment:e.state.isLastComment[n],submittingComment:e.state.submittingComment[n],valueComment:e.state.valueComment[n],showReply:e.state.showReply[n],valueReply:e.state.valueReply[n],submittingReply:e.state.submittingReply[n],handleChangeComment:e.handleChangeComment,handleSubmitComment:e.handleSubmitComment,onComment:e.onComment,onReply:e.onReply,handleChangeReply:e.handleChangeReply,handleSubmitReply:e.handleSubmitReply,updateName:e.updateName,onFollowPost:e.onFollowPost,deleteFollowPost:e.deleteFollowPost,onDeletePost:e.showModalDeletePost,onLikePost:e.onLikePost,currentUser:e.props.currentUser,key:a.id,post:a,currentVote:e.state.currentVotes[n],postIndex:n,addAChoice:e.addAChoice,handleDeleteChoiceSubmit:e.showModal,handleShowListVoted:e.showModalListVoted,handleDeleteVoteSubmit:e.handleDeleteVoteSubmit,onEndPoll:e.onEndPoll,handleVoteChange:e.handleVoteChange,handleVoteSubmit:e.handleVoteSubmit}))})),o.a.createElement("div",{className:"polls-container"},o.a.createElement(V.a,{title:"Confirm your action",visible:this.state.visible,onOk:this.handleDeleteChoiceSubmit,onCancel:this.handleCancel,footer:[o.a.createElement(D.a,{key:"back",onClick:this.handleCancel},"Return"),o.a.createElement(D.a,{key:"submit",type:"primary",onClick:this.handleDeleteChoiceSubmit},"Submit")]},o.a.createElement("p",null,"Are you want delete this choice?")),o.a.createElement(V.a,{title:"Confirm your action",visible:this.state.visibleReplyDelete,onOk:this.handleDeleteReplySubmit,onCancel:this.handleCancelReply,footer:[o.a.createElement(D.a,{key:"back",onClick:this.handleCancelReply},"Return"),o.a.createElement(D.a,{key:"submit",type:"primary",onClick:this.handleDeleteReplySubmit},"Submit")]},o.a.createElement("p",null,"Are you want delete this reply?")),o.a.createElement(V.a,{title:"Confirm your action",visible:this.state.visiblePost,onOk:this.handleDeletePostSubmit,onCancel:this.handleCancelPost,footer:[o.a.createElement(D.a,{key:"back",onClick:this.handleCancelPost},"Return"),o.a.createElement(D.a,{key:"submit",type:"primary",onClick:this.handleDeletePostSubmit},"Submit")]},o.a.createElement("p",null,"Are you want delete this post?")),o.a.createElement(V.a,{title:"Confirm your action",visible:this.state.visibleCommentDelete,onOk:this.handleDeleteCommentSubmit,onCancel:this.handleCancelComment,footer:[o.a.createElement(D.a,{key:"back",onClick:this.handleCancelComment},"Return"),o.a.createElement(D.a,{key:"submit",type:"primary",onClick:this.handleDeleteCommentSubmit},"Submit")]},o.a.createElement("p",null,"Are you want delete this comment?")),o.a.createElement(V.a,{title:"List User Voted This Choice",centered:!0,visible:this.state.visibleListVoted,onCancel:this.handleCancelListVoted,footer:[o.a.createElement(D.a,{key:"back",onClick:this.handleCancelListVoted},"Return")]},o.a.createElement(M.b,{itemLayout:"horizontal",dataSource:this.state.votedUsers,renderItem:function(e){return o.a.createElement(M.b.Item,null,o.a.createElement(M.b.Item.Meta,{avatar:null==e.photo?o.a.createElement(O.a,{className:"poll-creator-avatar2",style:{backgroundColor:oe(e.name)}},e.name[0].toUpperCase()):o.a.createElement(O.a,{className:"poll-creator-avatar2",src:"https://drive.google.com/uc?export=view&id="+e.photo}),title:o.a.createElement("div",null,e.name," ",o.a.createElement("span",{style:{color:"#657786"}},"@",e.username)),description:o.a.createElement("span",null,"Voted: ",e.count)}))}}),this.state.isLoading2||this.state.last2?null:o.a.createElement("div",{className:"load-more-polls"},o.a.createElement(D.a,{type:"dashed",onClick:this.handleLoadMoreUserVoted,disabled:this.state.isLoading2},o.a.createElement(he.a,null)," Load more")),this.state.isLoading2?o.a.createElement(Ae,null):null),o.a.createElement(Me.a,{initialLoad:!1,pageStart:this.state.page,loadMore:this.handleLoadMore,hasMore:!this.state.isLoading&&!this.state.last,threshold:1500,useWindow:!0},t,this.state.isloading&&o.a.createElement("div",{className:"demo-loading-container"},o.a.createElement(Ae,null))),o.a.createElement(L.a,null,o.a.createElement("div",{style:{height:40,width:40,lineHeight:"40px",borderRadius:4,backgroundColor:"#fff",color:"rgb(0 0 0)",textAlign:"center",fontSize:14,boxShadow:"0 2px 2px 0 rgb(0 0 0 / 16%), 0 0 0 1px rgb(0 0 0 / 8%)"}},o.a.createElement(Ie.a,null))))}}]),a}(n.Component),Te=Object(u.g)(je),Fe=(a(414),a(191)),Ge=(a(245),a(185)),_e=(a(438),a(254)),ze=a(111),Be=(a(207),a(81)),Ye=(a(148),a(54)),He=(a(420),a(60)),qe=a(78),We=a.n(qe),Ke=Ye.a.Option,Je=Be.a.getMentions,Qe=ee.a.Item,$e=te.a.TextArea,Xe=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).range=function(e,t){for(var a=[],n=e;n<t;n++)a.push(n);return a},n.disabledDate=function(e){return e<We()().endOf("day")},n.disabledDateTime=function(){return{disabledHours:function(){return n.range(0,0)},disabledMinutes:function(){return n.range(0,0)},disabledSeconds:function(){return n.range(0,0)}}},n.addChoice=function(e,t){var a=n.state.polls.slice(),o=a[t].choices.slice();a[t].choices=o.concat([{text:"",photo:null,review:null}]),n.setState({polls:a})},n.addPoll=function(e){var t=n.state.polls.slice();n.setState({polls:t.concat([{question:{text:""},choices:[{text:"",photo:null,review:null},{text:"",photo:null,review:null}],pollLength:{days:1,hours:0},photo:"",isUnseenUserForVote:!1,isUnseenUserForAddChoice:!1,isAddChoice:!1,isCanFix:!0,showResultCase:1,maxVotePerTimeLoad:1,maxVotePerChoice:1,maxVoteOfPoll:1,timeLoad:{days:0,hours:0},isHasPollLength:!0}])})},n.removeChoice=function(e,t){var a=n.state.polls.slice(),o=a[t].choices.slice();a[t].choices=[].concat(Object(ze.a)(o.slice(0,e)),Object(ze.a)(o.slice(e+1))),n.setState({polls:a})},n.removePoll=function(e){var t=n.state.polls.slice();n.setState({polls:[].concat(Object(ze.a)(t.slice(0,e)),Object(ze.a)(t.slice(e+1)))})},n.onSearch=function(e){n.setState({search:e,loading:!!e}),n.loadUserList(e)},n.onSearchGroup=function(e){n.setState({search:e,loading:!!e}),n.loadGroupList(e)},n.loadUserList=function(e){var t;(t=x(e,"username"))&&t.then((function(e){var t=e.filter((function(e){var t=!0;return n.state.usersSend.forEach((function(a){e.username===a&&(t=!1)})),t}));n.setState({users:t,loading:!1})})).catch((function(e){}))},n.loadGroupList=function(e){var t,a;a=e,(t=localStorage.getItem(d)?v({url:m+"/groups/find?name="+a,method:"GET"}):Promise.reject("No access token set."))&&t.then((function(e){var t=e.filter((function(e){var t=!0;return n.state.groupsSend.forEach((function(a){e.code===a&&(t=!1)})),t}));n.setState({groups:t,loading:!1})})).catch((function(e){}))},n.validateQuestion=function(e){return 0===e.length?{validateStatus:"error",errorMsg:"Please enter your question!"}:e.length>140?{validateStatus:"error",errorMsg:"Question is too long (Maximum ".concat(140," characters allowed)")}:{validateStatus:"success",errorMsg:null}},n.handleQuestionChange=function(e,t){var a=e.target.value,o=n.state.polls.slice(),s=Object.assign(n.state.polls[t],{question:Object(R.a)({text:a},n.validateQuestion(a))});o[t]=s,n.setState({polls:o})},n.validateChoice=function(e){return 0===e.length?{validateStatus:"error",errorMsg:"Please enter a choice!"}:e.length>40?{validateStatus:"error",errorMsg:"Choice is too long (Maximum ".concat(40," characters allowed)")}:{validateStatus:"success",errorMsg:null}},n.handleChoiceChange=function(e,t,a){var o=n.state.polls.slice(),s=e.target.value,r=Object.assign(n.state.polls[a].choices[t],Object(R.a)({text:s},n.validateChoice(s)));o[a].choices[t]=r,n.setState({polls:o})},n.handlePollDaysChange=function(e,t){var a=n.state.polls.slice(),o=Object.assign(a[t].pollLength,{days:e});a[t].pollLength=o,n.setState({polls:a})},n.handlePollHoursChange=function(e,t){var a=n.state.polls.slice(),o=Object.assign(a[t].pollLength,{hours:e});a[t].pollLength=o,n.setState({polls:a})},n.handleTimeLoadDaysChange=function(e,t){var a=n.state.polls.slice(),o=Object.assign(a[t].timeLoad,{days:e});a[t].timeLoad=o,n.setState({polls:a})},n.handleTimeLoadHoursChange=function(e,t){var a=n.state.polls.slice(),o=Object.assign(a[t].timeLoad,{hours:e});a[t].timeLoad=o,n.setState({polls:a})},n.onChangeIsUnseenUserForVote=function(e){var t=n.state.polls.slice(),a=t[e].isUnseenUserForVote;t[e].isUnseenUserForVote=!a,n.setState({polls:t})},n.onChangeIsUnseenUserForAddChoice=function(e){var t=n.state.polls.slice(),a=t[e].isUnseenUserForAddChoice;t[e].isUnseenUserForAddChoice=!a,n.setState({polls:t})},n.onChangeIsAddChoice=function(e){var t=n.state.polls.slice(),a=t[e].isAddChoice;t[e].isAddChoice=!a,n.setState({polls:t})},n.onChangeIsCanFix=function(e){var t=n.state.polls.slice(),a=t[e].isCanFix;t[e].isCanFix=!a,n.setState({polls:t})},n.onChangeIsHasPollLength=function(e){var t=n.state.polls.slice(),a=t[e].isHasPollLength;t[e].isHasPollLength=!a,n.setState({polls:t})},n.onChangeIsUnseenOwner=function(){n.setState({isUnseenOwner:!n.state.isUnseenOwner})},n.onChangeIsDelay=function(){n.setState({isDelay:!n.state.isDelay})},n.handleChangemaxVoteOfPoll=function(e,t){var a=n.state.polls.slice();a[t].maxVoteOfPoll=e,n.setState({polls:a})},n.handleChangemaxVotePerChoice=function(e,t){var a=n.state.polls.slice();a[t].maxVotePerChoice=e,n.setState({polls:a})},n.handleChangemaxVotePerTimeLoad=function(e,t){var a=n.state.polls.slice();a[t].maxVotePerTimeLoad=e,a[t].maxVoteOfPoll<e&&(a[t].maxVoteOfPoll=e),n.setState({polls:a})},n.handleQuestionForPostChange=function(e){var t=e.target.value;n.setState({question:Object(R.a)({text:t},n.validateQuestion(t))})},n.handleShowResultCaseChange=function(e,t){var a=n.state.polls.slice(),o=Object.assign(a[t],{showResultCase:e});a[t]=o,n.setState({polls:a})},n.handleShowCaseChange=function(e){n.setState({showCase:e})},n.onSelect=function(e){var t=Je(e),a=[];t.forEach((function(e){a.push(e.value)})),n.setState(Object(R.a)({usersSend:a},n.validateUsers(a)))},n.onSelectGroup=function(e){var t=Je(e),a=[];t.forEach((function(e){a.push(e.value)})),n.setState(Object(R.a)({groupsSend:a},n.validateGroups(a)))},n.validateGroups=function(e){return 0===e.length?{validateStatusGroup:"error",errorMsgGroup:"Please enter a group code!"}:e.length>2?{validateStatusGroup:"error",errorMsgGroup:"Group is too much (Maximum ".concat(2," group allowed)")}:{validateStatusGroup:"success",errorMsgGroup:null}},n.validateUsers=function(e){return 0===e.length?{validateStatusUser:"error",errorMsgUser:"Please enter a username!"}:e.length>g?{validateStatusUser:"error",errorMsgUser:"User is too much (Maximum ".concat(g," user allowed)")}:{validateStatusUser:"success",errorMsgUser:null}},n.onChangeUpload=function(e,t){if(e.file.status,0===e.fileList.length){var a=n.state.polls.slice();k(a[t].photo),a[t].photo=null,n.setState({polls:a})}if("done"===e.file.status){var o=n.state.polls.slice();console.log(e.fileList[0].response),o[t].photo=e.fileList[0].response.id,n.setState({polls:o}),l.a.success({message:"Polling App",description:"".concat(e.file.name," file uploaded successfully")})}else"error"===e.file.status&&(console.log(e),null!=e.file.response?l.a.error({message:"Polling App",description:"".concat(e.file.response.message)}):l.a.error({message:"Polling App",description:"".concat(e.file.name," file upload failed. Max file size is 20MB")}))},n.onChangeUploadChoice=function(e,t,a){if(e.file.status,0===e.fileList.length){var o=n.state.polls.slice();k(o[a].choices[t].photo);var s=Object.assign(o[a].choices[t],{photo:null});o[a].choices[t]=s,n.setState({polls:o})}if("done"===e.file.status){var r=n.state.polls.slice(),i=Object.assign(n.state.polls[a].choices[t],{photo:e.fileList[0].response.id});r[a].choices[t]=i,n.setState({polls:r}),l.a.success({message:"Polling App",description:"".concat(e.file.name," file uploaded successfully")})}else"error"===e.file.status&&(null!=e.file.response?l.a.error({message:"Polling App",description:"".concat(e.file.response.message)}):l.a.error({message:"Polling App",description:"".concat(e.file.name," file upload failed. Max file size is 20MB")}))},n.handleChoiceChangeReview=function(e,t,a){var o=n.state.polls.slice(),s=e.target.value,r=Object.assign(n.state.polls[a].choices[t],Object(R.a)({review:s},n.validateChoice(n.state.polls[a].choices[t].text)));o[a].choices[t]=r,n.setState({polls:o})},n.state={question:{text:""},polls:[{question:{text:""},choices:[{text:"",photo:null,review:null},{text:"",photo:null,review:null}],pollLength:{days:1,hours:0},photo:"",isUnseenUserForVote:!1,isUnseenUserForAddChoice:!1,isAddChoice:!1,isCanFix:!0,showResultCase:1,maxVotePerTimeLoad:1,maxVotePerChoice:1,maxVoteOfPoll:1,timeLoad:{days:0,hours:0},isHasPollLength:!0}],isUnseenOwner:!1,showCase:3,publicDateMoment:"",publicDate:"",isDelay:!1,users:[],groups:[],usersSend:[],groupsSend:[],search:"",loading:!1},n.handleSubmit=n.handleSubmit.bind(Object(F.a)(n)),n.isFormInvalid=n.isFormInvalid.bind(Object(F.a)(n)),n.handlePublicDateChange=n.handlePublicDateChange.bind(Object(F.a)(n)),n}return Object(T.a)(a,[{key:"handlePublicDateChange",value:function(e){this.setState({publicDateMoment:e})}},{key:"handleSubmit",value:function(){var e=this,t={question:this.state.question.text,polls:this.state.polls.map((function(e){return e.isHasPollLength?{question:e.question.text,choices:e.choices.map((function(e){return{text:e.text,photo:e.photo,review:e.review}})),photo:e.photo,pollLength:e.pollLength,isUnseenUserForVote:e.isUnseenUserForVote,isUnseenUserForAddChoice:e.isUnseenUserForAddChoice,isAddChoice:e.isAddChoice,isCanFix:e.isCanFix,showResultCase:e.showResultCase,maxVotePerTimeLoad:e.maxVotePerTimeLoad,maxVotePerChoice:e.maxVotePerChoice,maxVoteOfPoll:e.maxVoteOfPoll,timeLoad:e.timeLoad}:{question:e.question.text,choices:e.choices.map((function(e){return{text:e.text,photo:e.photo,review:e.review}})),photo:e.photo,isUnseenUserForVote:e.isUnseenUserForVote,isUnseenUserForAddChoice:e.isUnseenUserForAddChoice,isAddChoice:e.isAddChoice,isCanFix:e.isCanFix,showResultCase:e.showResultCase,maxVotePerTimeLoad:e.maxVotePerTimeLoad,maxVotePerChoice:e.maxVotePerChoice,maxVoteOfPoll:e.maxVoteOfPoll,timeLoad:e.timeLoad}})),isUnseenOwner:this.state.isUnseenOwner,showCase:this.state.showCase,publicDate:null,usersUsername:this.state.usersSend,groups:this.state.groupsSend};this.state.isDelay&&""!==this.state.publicDateMoment&&(t.publicDate=this.state.publicDateMoment.format("DD-MM-YYYY HH:mm:ss")),function(e){return v({url:m+"/polls",method:"POST",body:JSON.stringify(e)})}(t).then((function(t){e.props.history.push("/")})).catch((function(t){401===t.status?e.props.handleLogout("/login","error","You have been logged out. Please login create poll."):l.a.error({message:"Polling App",description:t.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"isFormInvalid",value:function(){if("success"!==this.state.question.validateStatus)return!0;if(5===this.state.showCase&&"success"!==this.state.validateStatusGroup)return!0;if(4===this.state.showCase&&"success"!==this.state.validateStatusUser)return!0;for(var e=0;e<this.state.polls.length;e++){var t=this.state.polls[e];if("success"!==t.question.validateStatus)return!0;for(var a=0;a<t.choices.length;a++){if("success"!==t.choices[a].validateStatus)return!0}}}},{key:"componentDidMount",value:function(){this.loadUserList(""),this.loadGroupList("")}},{key:"render",value:function(){var e=this,t=[];this.state.users.forEach((function(e,a){t.push(o.a.createElement(Ke,{key:a,value:e.id},o.a.createElement(O.a,{className:"poll-creator-avatar",style:{backgroundColor:oe(e.name)}},e.name[0].toUpperCase()),o.a.createElement("span",{className:"poll-creator-name"},e.name)))}));var a=[];return this.state.polls.forEach((function(t,n){var s=[];t.choices.forEach((function(t,a){s.push(o.a.createElement(et,{key:a,choice:t,choiceNumber:a,pollNumber:n,removeChoice:e.removeChoice,handleChoiceChange:e.handleChoiceChange,handleChoiceChangeReview:e.handleChoiceChangeReview,onChangeUploadChoice:e.onChangeUploadChoice}))})),a.push(o.a.createElement(Ze,{key:n,poll:t,choiceViews:s,pollNumber:n,handleQuestionChange:e.handleQuestionChange,addChoice:e.addChoice,handlePollDaysChange:e.handlePollDaysChange,handlePollHoursChange:e.handlePollHoursChange,onChangeIsUnseenUserForVote:e.onChangeIsUnseenUserForVote,onChangeIsUnseenUserForAddChoice:e.onChangeIsUnseenUserForAddChoice,onChangeIsAddChoice:e.onChangeIsAddChoice,onChangeIsCanFix:e.onChangeIsCanFix,handleChangemaxVotePerTimeLoad:e.handleChangemaxVotePerTimeLoad,handleChangemaxVotePerChoice:e.handleChangemaxVotePerChoice,handleChangemaxVoteOfPoll:e.handleChangemaxVoteOfPoll,handleTimeLoadDaysChange:e.handleTimeLoadDaysChange,handleTimeLoadHoursChange:e.handleTimeLoadHoursChange,handleShowResultCaseChange:e.handleShowResultCaseChange,onChangeUpload:e.onChangeUpload,removePoll:e.removePoll,onChangeIsHasPollLength:e.onChangeIsHasPollLength}))})),o.a.createElement("div",{className:"new-poll-container"},o.a.createElement("h1",{className:"page-title"},"Create Post"),o.a.createElement("div",{className:"new-poll-content"},o.a.createElement(ee.a,{onFinish:this.handleSubmit,className:"create-poll-form"},o.a.createElement(Qe,{className:"poll-form-row"},o.a.createElement($e,{placeholder:"Enter your question",style:{fontSize:"16px"},autosize:{minRows:3,maxRows:6},name:"question",value:this.state.question.text,onChange:this.handleQuestionForPostChange})),o.a.createElement(B.a,{gutter:[48,16]},o.a.createElement(H.a,{xs:12},"\u0110\u0103ng \u1ea9n danh"),o.a.createElement(H.a,{xs:12},o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",onChange:this.onChangeIsUnseenOwner})),o.a.createElement(H.a,{span:12},"Ch\u1ebf \u0111\u1ed9 \u0111\u0103ng:"),o.a.createElement(H.a,{span:12},o.a.createElement(Ye.a,{name:"hours",onChange:this.handleShowCaseChange,value:this.state.showCase,style:{width:200}},o.a.createElement(Ke,{key:1,value:1},"B\xed m\u1eadt"),o.a.createElement(Ke,{key:2,value:2},"Ri\xeang t\u01b0"),o.a.createElement(Ke,{key:3,value:3},"C\xf4ng khai"),o.a.createElement(Ke,{key:4,value:4},"Gi\u1edbi h\u1ea1n ng\u01b0\u1eddi"),o.a.createElement(Ke,{key:5,value:5},"Nh\xf3m"))),4===this.state.showCase?o.a.createElement(H.a,{xs:12},"Nh\u1eefng ng\u01b0\u1eddi s\u1ebd nh\xecn th\u1ea5y b\xe0i \u0111\u0103ng: "):null,4===this.state.showCase?o.a.createElement(H.a,{xs:12},o.a.createElement(Qe,{validateStatus:this.state.validateStatusUser,help:this.state.errorMsgUser},o.a.createElement(Be.a,{style:{width:"100%"},placeholder:"Nh\u1eadp '@' \u0111\u1ec3 tag b\u1ea1n b\xe8",loading:this.state.loading,onSearch:this.onSearch,onChange:this.onSelect},this.state.users.map((function(e){var t=e.id,a=e.username,n=e.name;return o.a.createElement(Ke,{key:t,value:a,className:"antd-demo-dynamic-option"},o.a.createElement("span",null,n," @",a))}))))):null,5===this.state.showCase?o.a.createElement(H.a,{xs:12},"Nh\u1eefng nh\xf3m s\u1ebd \u0111\u0103ng: "):null,5===this.state.showCase?o.a.createElement(H.a,{xs:12},o.a.createElement(Qe,{validateStatus:this.state.validateStatusGroup,help:this.state.errorMsgGroup},o.a.createElement(Be.a,{style:{width:"100%"},placeholder:"Nh\u1eadp '@' \u0111\u1ec3 tag nh\xf3m",loading:this.state.loading,onSearch:this.onSearchGroup,onChange:this.onSelectGroup},this.state.groups.map((function(e){return o.a.createElement(Ke,{key:e.id,value:e.code,className:"antd-demo-dynamic-option"},o.a.createElement("span",null,e.name," @",e.code))}))))):null,o.a.createElement(H.a,{xs:12},"L\xean l\u1ecbch \u0111\u0103ng b\xe0i"),o.a.createElement(H.a,{xs:12},o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",onChange:this.onChangeIsDelay})),this.state.isDelay?o.a.createElement(H.a,{span:12},"Ng\xe0y gi\u1edd \u0111\u0103ng:"):null,this.state.isDelay?o.a.createElement(H.a,{span:12},o.a.createElement(Ge.b,{direction:"vertical",size:12},o.a.createElement(_e.a,{format:"DD-MM-YYYY HH:mm:ss",disabledDate:this.disabledDate,disabledTime:this.disabledDateTime,showTime:{defaultValue:We()("00:00:00","HH:mm:ss")},showNow:!1,value:this.state.publicDateMoment,onChange:this.handlePublicDateChange}))):null),a,o.a.createElement(Qe,{className:"poll-form-row"},o.a.createElement(D.a,{type:"dashed",onClick:this.addPoll},o.a.createElement(he.a,null)," Add a Poll")),o.a.createElement(Qe,{className:"poll-form-row"},o.a.createElement(D.a,{type:"primary",htmlType:"submit",size:"large",disabled:this.isFormInvalid(),className:"create-poll-form-button"},"Create Post")))))}}]),a}(n.Component),Ze=function(e){var t={name:"file",action:m+"/file/upload",headers:{authorization:"Bearer "+localStorage.getItem(d)}};return o.a.createElement("div",{className:"new-poll-container"},o.a.createElement("h1",{className:"page-title"},"Create Poll ",e.pollNumber+1,e.pollNumber>0?o.a.createElement(He.a,{className:"dynamic-delete-button-poll",disabled:0===e.pollNumber,onClick:function(){return e.removePoll(e.pollNumber)}}):null),o.a.createElement("div",{className:"new-poll-content"},o.a.createElement(Qe,{className:"poll-form-row"},o.a.createElement($e,{placeholder:"Enter your question",style:{fontSize:"16px"},autosize:{minRows:3,maxRows:6},name:"question",value:e.poll.question.text,onChange:function(t){return e.handleQuestionChange(t,e.pollNumber)}})),o.a.createElement(Qe,{className:"poll-form-row"},o.a.createElement(X.a,Object.assign({},t,{listType:"picture",maxCount:1,onChange:function(t){return e.onChangeUpload(t,e.pollNumber)}}),""===e.poll.photo?o.a.createElement(D.a,{icon:o.a.createElement(le.a,null)},"Upload (Max: 1)"):null)),e.choiceViews,o.a.createElement(Qe,{className:"poll-form-row"},o.a.createElement(D.a,{type:"dashed",onClick:function(t){return e.addChoice(t,e.pollNumber)},disabled:6===e.poll.choices.length},o.a.createElement(he.a,null)," Add a choice")),o.a.createElement(B.a,{gutter:[48,16]},o.a.createElement(H.a,{span:12},"Th\u1eddi h\u1ea1n k\u1ebft th\xfac: \xa0"),o.a.createElement(H.a,{span:12},o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",defaultChecked:!0,onChange:function(){return e.onChangeIsHasPollLength(e.pollNumber)}})),e.poll.isHasPollLength?o.a.createElement(H.a,{span:12},"Poll length:"):null,e.poll.isHasPollLength?o.a.createElement(H.a,{span:12},o.a.createElement("span",{style:{marginRight:"18px"}},o.a.createElement(Ye.a,{name:"days",defaultValue:"1",onChange:function(t){return e.handlePollDaysChange(t,e.pollNumber)},value:e.poll.pollLength.days,style:{width:60}},Array.from(Array(8).keys()).map((function(e){return o.a.createElement(Ke,{key:e},e)})))," \xa0Days"),o.a.createElement("span",null,o.a.createElement(Ye.a,{name:"hours",defaultValue:"0",onChange:function(t){return e.handlePollHoursChange(t,e.pollNumber)},value:e.poll.pollLength.hours,style:{width:60}},Array.from(Array(24).keys()).map((function(e){return o.a.createElement(Ke,{key:e},e)})))," \xa0Hours")):null,o.a.createElement(H.a,{span:12},"B\u1ea7u ch\u1ecdn \u1ea9n danh\xa0"),o.a.createElement(H.a,{span:12},o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",onChange:function(){return e.onChangeIsUnseenUserForVote(e.pollNumber)}})),o.a.createElement(H.a,{span:12},"Cho ph\xe9p th\xeam l\u1ef1a ch\u1ecdn\xa0"),o.a.createElement(H.a,{span:12},o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",onChange:function(){return e.onChangeIsAddChoice(e.pollNumber)}})),e.poll.isAddChoice?o.a.createElement(H.a,{span:12},"Ng\u01b0\u1eddi th\xeam l\u1ef1a ch\u1ecdn b\u1ecb \u1ea9n danh\xa0"):null,e.poll.isAddChoice?o.a.createElement(H.a,{span:12},o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",disabled:!e.poll.isAddChoice,onChange:function(){return e.onChangeIsUnseenUserForAddChoice(e.pollNumber)}})):null,o.a.createElement(H.a,{span:12},"Cho ph\xe9p s\u1eeda l\u1ef1a ch\u1ecdn\xa0"),o.a.createElement(H.a,{span:12},o.a.createElement(Y.a,{checkedChildren:"C\xf3",unCheckedChildren:"Kh\xf4ng",defaultChecked:!0,onChange:function(){return e.onChangeIsCanFix(e.pollNumber)}})),o.a.createElement(H.a,{span:12},"S\u1ed1 l\u01b0\u1ee3ng phi\u1ebfu b\u1ea7u t\u1ed1i \u0111a:"),o.a.createElement(H.a,{span:12},o.a.createElement(Fe.a,{min:1,defaultValue:1,value:e.poll.maxVotePerTimeLoad,onChange:function(t){return e.handleChangemaxVotePerTimeLoad(t,e.pollNumber)}}),"\xa0L\u1ea7n"),o.a.createElement(H.a,{span:12},"M\u1ed7i l\u1ef1a ch\u1ecdn \u0111\u01b0\u1ee3c b\u1ea7u t\u1ed1i \u0111a:"),o.a.createElement(H.a,{span:12},o.a.createElement(Fe.a,{min:1,defaultValue:1,value:e.poll.maxVotePerChoice,onChange:function(t){return e.handleChangemaxVotePerChoice(t,e.pollNumber)}}),"\xa0L\u1ea7n"),0===e.poll.timeLoad.hours&&0===e.poll.timeLoad.days?null:o.a.createElement(H.a,{span:12},"S\u1ed1 l\u01b0\u1ee3ng phi\u1ebfu b\u1ea7u t\u1ed1i \u0111a 2:"),0===e.poll.timeLoad.hours&&0===e.poll.timeLoad.days?null:o.a.createElement(H.a,{span:12},o.a.createElement(Fe.a,{min:1,defaultValue:1,value:e.poll.maxVoteOfPoll,disabled:0===e.poll.timeLoad.hours&&0===e.poll.timeLoad.days,onChange:function(t){return e.handleChangemaxVoteOfPoll(t,e.pollNumber)}}),"\xa0L\u1ea7n"),o.a.createElement(H.a,{style:{display:"none"},span:12},"Th\u1eddi gian \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp l\u1ea1i s\u1ed1 phi\u1ebfu:"),o.a.createElement(H.a,{span:12,style:{display:"none"}},o.a.createElement("span",{style:{marginRight:"18px"}},o.a.createElement(Ye.a,{name:"days",defaultValue:"1",onChange:function(t){return e.handleTimeLoadDaysChange(t,e.pollNumber)},value:e.poll.timeLoad.days,style:{width:60}},Array.from(Array(8).keys()).map((function(e){return o.a.createElement(Ke,{key:e},e)})))," \xa0Days"),o.a.createElement("span",null,o.a.createElement(Ye.a,{name:"hours",defaultValue:"0",onChange:function(t){return e.handleTimeLoadHoursChange(t,e.pollNumber)},value:e.poll.timeLoad.hours,style:{width:60}},Array.from(Array(24).keys()).map((function(e){return o.a.createElement(Ke,{key:e},e)})))," \xa0Hours")),o.a.createElement(H.a,{span:12},"Ch\u1ebf \u0111\u1ed9 hi\u1ec3n th\u1ecb k\u1ebft qu\u1ea3:"),o.a.createElement(H.a,{span:12},o.a.createElement(Ye.a,{name:"hours",onChange:function(t){return e.handleShowResultCaseChange(t,e.pollNumber)},value:e.poll.showResultCase,style:{width:200}},o.a.createElement(Ke,{key:1,value:1},"\u0110\u01b0\u1ee3c xem ngay"),o.a.createElement(Ke,{key:2,value:2},"Sau khi k\u1ebft th\xfac"),o.a.createElement(Ke,{key:3,value:3,disabled:!!e.poll.isCanFix},"Sau khi b\u1ea7u"),o.a.createElement(Ke,{key:4,value:4},"Kh\xf4ng \u0111\u01b0\u1ee3c xem"))))))},et=function(e){var t={name:"file",action:m+"/file/upload",headers:{authorization:"Bearer "+localStorage.getItem(d)}};return o.a.createElement(Qe,{validateStatus:e.choice.validateStatus,help:e.choice.errorMsg,className:"poll-form-row"},o.a.createElement(te.a,{placeholder:"Choice "+(e.choiceNumber+1),size:"large",value:e.choice.text,className:e.choiceNumber>1?"optional-choice":null,onChange:function(t){return e.handleChoiceChange(t,e.choiceNumber,e.pollNumber)}}),e.choiceNumber>1?o.a.createElement(He.a,{className:"dynamic-delete-button",disabled:e.choiceNumber<=1,onClick:function(){return e.removeChoice(e.choiceNumber,e.pollNumber)}}):null,o.a.createElement($e,{placeholder:"Review "+(e.choiceNumber+1),size:"large",value:e.choice.review,className:e.choiceNumber>1?"optional-textchoice":"choice",onChange:function(t){return e.handleChoiceChangeReview(t,e.choiceNumber,e.pollNumber)}}),o.a.createElement(X.a,Object.assign({},t,{listType:"picture",className:"upload-inline",maxCount:1,onChange:function(t){return e.onChangeUploadChoice(t,e.choiceNumber,e.pollNumber)}}),null==e.choice.photo?o.a.createElement(D.a,{className:"button-upload",icon:o.a.createElement(le.a,null)},"Upload"):o.a.createElement(D.a,{className:"button-upload",disabled:!0,icon:o.a.createElement(le.a,null)},"Upload")))},tt=Xe,at=(a(421),a(448)),nt=a(449),ot=ee.a.Item,st=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){(function(e){return v({url:m+"/auth/signin",method:"POST",body:JSON.stringify(e)})})(Object.assign({},e)).then((function(e){localStorage.setItem(d,e.accessToken),n.props.onLogin()})).catch((function(e){401===e.status?l.a.error({message:"Polling App",description:"Your Username or Password is incorrect. Please try again!"}):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))},n.handleSubmit=n.handleSubmit.bind(Object(F.a)(n)),n}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e,t=this;console.log(this.props.type),"confirm"===this.props.type&&(this.props.history.push("/login"),(e=this.props.match.params.code,v({url:m+"/auth/active?token="+e,method:"GET"})).then((function(e){l.a.success({message:"Polling App",description:"Your accout is Active. Welcome to website!"}),t.props.history.push("/login")})).catch((function(e){401===e.status?l.a.error({message:"Polling App",description:"Your Username or Password is incorrect. Please try again!"}):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})))}},{key:"render",value:function(){return o.a.createElement("div",{className:"login-container"},o.a.createElement("h1",{className:"page-title"},"Login"),o.a.createElement("div",{className:"login-content"},o.a.createElement(ee.a,{onFinish:this.handleSubmit,className:"login-form"},o.a.createElement(ot,{name:"usernameOrEmail",rules:[{required:!0,message:"Please input your username or email!"}]},o.a.createElement(te.a,{prefix:o.a.createElement(at.a,null),size:"large",name:"usernameOrEmail",autoComplete:"usernameOrEmail",placeholder:"Username or Email"})),o.a.createElement(ot,{name:"password",rules:[{required:!0,message:"Please input your Password!"}]},o.a.createElement(te.a.Password,{prefix:o.a.createElement(nt.a,null),size:"large",name:"password",type:"password",autoComplete:"password",placeholder:"Password"})),o.a.createElement(ot,null,o.a.createElement(D.a,{type:"primary",htmlType:"submit",size:"large",className:"login-form-button"},"Login"),"Or ",o.a.createElement(ae.b,{to:"/signup"},"register now!")))))}}]),a}(n.Component),rt=a(80),lt=(a(422),ee.a.Item),it=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).validateName=function(e){return e.length<4?{validateStatus:"error",errorMsg:"Name is too short (Minimum ".concat(4," characters needed.)")}:e.length>p?{validationStatus:"error",errorMsg:"Name is too long (Maximum ".concat(p," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},n.validateEmail=function(e){return e?RegExp("[^@ ]+@[^@ ]+\\.[^@ ]+").test(e)?e.length>40?{validateStatus:"error",errorMsg:"Email is too long (Maximum ".concat(40," characters allowed)")}:{validateStatus:null,errorMsg:null}:{validateStatus:"error",errorMsg:"Email not valid"}:{validateStatus:"error",errorMsg:"Email may not be empty"}},n.validateUsername=function(e){return e.length<3?{validateStatus:"error",errorMsg:"Username is too short (Minimum ".concat(3," characters needed.)")}:e.length>15?{validationStatus:"error",errorMsg:"Username is too long (Maximum ".concat(15," characters allowed.)")}:{validateStatus:null,errorMsg:null}},n.validatePassword=function(e){return e.length<6?{validateStatus:"error",errorMsg:"Password is too short (Minimum ".concat(6," characters needed.)")}:e.length>20?{validationStatus:"error",errorMsg:"Password is too long (Maximum ".concat(20," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},n.state={name:{value:""},username:{value:""},email:{value:""},password:{value:""}},n.handleInputChange=n.handleInputChange.bind(Object(F.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(F.a)(n)),n.validateUsernameAvailability=n.validateUsernameAvailability.bind(Object(F.a)(n)),n.validateEmailAvailability=n.validateEmailAvailability.bind(Object(F.a)(n)),n.isFormInvalid=n.isFormInvalid.bind(Object(F.a)(n)),n}return Object(T.a)(a,[{key:"handleInputChange",value:function(e,t){var a=e.target,n=a.name,o=a.value;this.setState(Object(rt.a)({},n,Object(R.a)({value:o},t(o))))}},{key:"handleSubmit",value:function(){var e=this,t={name:this.state.name.value,email:this.state.email.value,username:this.state.username.value,password:this.state.password.value};l.a.success({message:"Polling App",description:"Thank you! Please check your mail!"}),function(e){return v({url:m+"/auth/signup",method:"POST",body:JSON.stringify(e)})}(t).then((function(t){e.props.history.push("/login")})).catch((function(e){l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"isFormInvalid",value:function(){return!("success"===this.state.name.validateStatus&&"success"===this.state.username.validateStatus&&"success"===this.state.email.validateStatus&&"success"===this.state.password.validateStatus)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"signup-container"},o.a.createElement("h1",{className:"page-title"},"Sign Up"),o.a.createElement("div",{className:"signup-content"},o.a.createElement(ee.a,{onFinish:this.handleSubmit,className:"signup-form"},o.a.createElement(lt,{label:"Full Name",validateStatus:this.state.name.validateStatus,help:this.state.name.errorMsg},o.a.createElement(te.a,{size:"large",name:"name",autoComplete:"off",placeholder:"Your full name",value:this.state.name.value,onChange:function(t){return e.handleInputChange(t,e.validateName)}})),o.a.createElement(lt,{label:"Username",hasFeedback:!0,validateStatus:this.state.username.validateStatus,help:this.state.username.errorMsg},o.a.createElement(te.a,{size:"large",name:"username",autoComplete:"off",placeholder:"A unique username",value:this.state.username.value,onBlur:this.validateUsernameAvailability,onChange:function(t){return e.handleInputChange(t,e.validateUsername)}})),o.a.createElement(lt,{label:"Email",hasFeedback:!0,validateStatus:this.state.email.validateStatus,help:this.state.email.errorMsg},o.a.createElement(te.a,{size:"large",name:"email",type:"email",autoComplete:"off",placeholder:"Your email",value:this.state.email.value,onBlur:this.validateEmailAvailability,onChange:function(t){return e.handleInputChange(t,e.validateEmail)}})),o.a.createElement(lt,{label:"Password",validateStatus:this.state.password.validateStatus,help:this.state.password.errorMsg},o.a.createElement(te.a,{size:"large",name:"password",type:"password",autoComplete:"off",placeholder:"A password between 6 to 20 characters",value:this.state.password.value,onChange:function(t){return e.handleInputChange(t,e.validatePassword)}})),o.a.createElement(lt,null,o.a.createElement(D.a,{type:"primary",htmlType:"submit",size:"large",className:"signup-form-button",disabled:this.isFormInvalid()},"Sign up"),"Already registed? ",o.a.createElement(ae.b,{to:"/login"},"Login now!")))))}},{key:"validateUsernameAvailability",value:function(){var e,t=this,a=this.state.username.value,n=this.validateUsername(a);"error"!==n.validateStatus?(this.setState({username:{value:a,validateStatus:"validating",errorMsg:null}}),(e=a,v({url:m+"/user/checkUsernameAvailability?username="+e,method:"GET"})).then((function(e){e.available?t.setState({username:{value:a,validateStatus:"success",errorMsg:null}}):t.setState({username:{value:a,validateStatus:"error",errorMsg:"This username is already taken"}})})).catch((function(e){t.setState({username:{value:a,validateStatus:"success",errorMsg:null}})}))):this.setState({username:Object(R.a)({value:a},n)})}},{key:"validateEmailAvailability",value:function(){var e,t=this,a=this.state.email.value,n=this.validateEmail(a);"error"!==n.validateStatus?(this.setState({email:{value:a,validateStatus:"validating",errorMsg:null}}),(e=a,v({url:m+"/user/checkEmailAvailability?email="+e,method:"GET"})).then((function(e){e.available?t.setState({email:{value:a,validateStatus:"success",errorMsg:null}}):t.setState({email:{value:a,validateStatus:"error",errorMsg:"This Email is already registered"}})})).catch((function(e){t.setState({email:{value:a,validateStatus:"success",errorMsg:null}})}))):this.setState({email:Object(R.a)({value:a},n)})}}]),a}(n.Component),ct=a(212),ut=a.n(ct),mt=a(252),dt=(a(219),a(127)),ht=(a(423),a(424),function(){return o.a.createElement("div",{className:"page-not-found"},o.a.createElement("h1",{className:"title"},"404"),o.a.createElement("div",{className:"desc"},"The Page you're looking for was not found."),o.a.createElement(ae.b,{to:"/"},o.a.createElement(D.a,{className:"go-back-btn",type:"primary",size:"large"},"Go Back")))}),pt=(a(425),function(){return o.a.createElement("div",{className:"server-error-page"},o.a.createElement("h1",{className:"server-error-title"},"500"),o.a.createElement("div",{className:"server-error-desc"},"Oops! Something went wrong at our Server. Why don't you go back?"),o.a.createElement(ae.b,{to:"/"},o.a.createElement(D.a,{className:"server-error-go-back-btn",type:"primary",size:"large"},"Go Back")))}),gt=a(256),vt=a(450),ft=a(451),Ct=dt.a.TabPane,Et=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.beforeUpload=function(){var e=Object(mt.a)(ut.a.mark((function e(t){var a;return ut.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n._isMounted&&n.setState((function(e){return{fileList:[].concat(Object(ze.a)(e.fileList),[t])}})),(a=new FormData).append("file",n.state.fileList[0]),(o=a,f({url:m+"/file/useravatar",method:"POST",body:o})).then((function(e){l.a.success({message:"Polling App",description:"Avatar file uploaded successfully"}),window.location=window.location.href})),n._isMounted&&n.setState({uploading:!0}),e.abrupt("return",!1);case 6:case"end":return e.stop()}var o}),e)})));return function(t){return e.apply(this,arguments)}}(),n.socketPoll=function(e){10===e.type&&l.a.info({message:"Notification",description:e.name,placement:"bottomLeft",onClick:function(){return n.props.history.push("/post/"+e.postId)}})},n.enter=function(e){var t=e.target.value;n._isMounted&&n.setState({isLoading:!0}),function(e){return v({url:m+"/user/me?name="+e,method:"PUT"})}(t).then((function(e){n._isMounted&&n.setState({user:Object(R.a)(Object(R.a)({},n.state.user),{},{name:t}),valueName:t}),l.a.success({message:"Polling App",description:e.message||"Change name Succesfully!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),n._isMounted&&n.setState({isEdit:!n.state.isEdit,isLoading:!1})},n.validateName=function(e){return e.length<4?{validateStatus:"error",errorMsg:"Name is too short (Minimum ".concat(4," characters needed.)")}:e.length>p?{validationStatus:"error",errorMsg:"Name is too long (Maximum ".concat(p," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},n.onEdit=function(){n.setState({isEdit:!n.state.isEdit})},n.onChangeName=function(e,t){var a=e.target.value;n.setState(Object(R.a)({valueName:a},t(a)))},n.state={user:null,urlImage:"",isLoading:!1,uploading:!1,fileResponse:[],fileList:[],isEdit:!1,valueName:"",stompClient:null},n.loadUserProfile=n.loadUserProfile.bind(Object(F.a)(n)),n}return Object(T.a)(a,[{key:"loadUserProfile",value:function(e){var t=this;this._isMounted&&this.setState({isLoading:!0}),function(e){return v({url:m+"/users/"+e,method:"GET"})}(e).then((function(e){t._isMounted&&t.setState({user:e,valueName:e.name,isLoading:!1})})).catch((function(e){404===e.status?t._isMounted&&t.setState({notFound:!0,isLoading:!1}):t._isMounted&&t.setState({serverError:!0,isLoading:!1})}))}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=this.props.match.params.username;if(null!=this.props.currentUser){this.loadUserProfile(t);var a=new Ve.a(m+"/ws"),n=Re.a.over(a),o={Authorization:"Bearer "+localStorage.getItem(d)};n.connect(o,(function(){n.subscribe("/user/queue/item",(function(t){return e.socketPoll(JSON.parse(t.body))}),o)})),this._isMounted&&this.setState({stompClient:n})}console.log("dimount profile")}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,null!=this.state.stompClient&&(this.state.stompClient.send("/app/stop",{}),this.state.stompClient.disconnect()),console.log("unmount")}},{key:"componentDidUpdate",value:function(e){this.props.match.params.username!==e.match.params.username&&this.loadUserProfile(e.match.params.username)}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return o.a.createElement(Ae,null);if(this.state.notFound)return o.a.createElement(ht,null);if(this.state.serverError)return o.a.createElement(pt,null);return o.a.createElement("div",{className:"profile"},this.state.user?o.a.createElement("div",{className:"user-profile"},o.a.createElement("div",{className:"user-details"},o.a.createElement("div",{className:"user-avatar"},this.props.currentUser.username===this.state.user.username?o.a.createElement(gt.a,{rotate:!0},o.a.createElement(X.a,{fileList:this.state.fileList,beforeUpload:this.beforeUpload},o.a.createElement(vt.a,{style:{position:"absolute",marginLeft:"52px",marginTop:"52px",zIndex:"1"}}),null==this.state.user.photo?o.a.createElement(O.a,{className:"user-avatar-circle ava",style:{backgroundColor:oe(this.state.user.name)}},this.state.user.name[0].toUpperCase()):o.a.createElement(O.a,{className:"user-avatar-circle  ava",src:"https://drive.google.com/uc?export=view&id="+this.state.user.photo}))):o.a.createElement(o.a.Fragment,null,null==this.state.user.photo?o.a.createElement(O.a,{className:"user-avatar-circle",style:{backgroundColor:oe(this.state.user.name)}},this.state.user.name[0].toUpperCase()):o.a.createElement(O.a,{className:"user-avatar-circle",src:"https://drive.google.com/uc?export=view&id="+this.state.user.photo}))),o.a.createElement("div",{className:"user-summary"},o.a.createElement("div",{className:"full-name"},this.state.isEdit?o.a.createElement(o.a.Fragment,null,o.a.createElement(ee.a,null,o.a.createElement(ee.a.Item,{validateStatus:this.state.validateStatus,help:this.state.errorMsg},o.a.createElement(te.a,{value:this.state.valueName,onChange:function(t){return e.onChangeName(t,e.validateName)},onPressEnter:this.enter}),o.a.createElement(D.a,{type:"text",shape:"circle",onClick:this.onEdit,style:{float:"right",position:"fixed"},icon:o.a.createElement(He.a,null)})))):o.a.createElement(o.a.Fragment,null,this.state.user.name,this.state.user.username===this.props.currentUser.username&&o.a.createElement(D.a,{type:"text",shape:"circle",onClick:this.onEdit,style:{float:"right"},icon:o.a.createElement(ft.a,null)}))),o.a.createElement("div",{className:"username"},"@",this.state.user.username),o.a.createElement("div",{className:"user-joined"},"Joined ",function(e){var t=new Date(e),a=t.getMonth(),n=t.getFullYear();return["January","February","March","April","May","June","July","August","September","October","November","December"][a]+" "+n}(this.state.user.joinedAt)))),o.a.createElement("div",{className:"user-poll-details"},o.a.createElement(dt.a,{defaultActiveKey:"1",animated:!1,tabBarStyle:{textAlign:"center"},size:"large",onChange:this.callBack,className:"profile-tabs"},o.a.createElement(Ct,{tab:"".concat(this.state.user.pollCount," Posts"),key:"1"},o.a.createElement(Te,{socket:!0,key:"1",currentUser:this.props.currentUser,handleLogout:this.props.handleLogout,username:this.props.match.params.username,type:"USER_CREATED_POSTS",isAuthenticated:this.props.isAuthenticated})),o.a.createElement(Ct,{tab:"".concat(this.state.user.voteCount," Votes"),key:"2"},o.a.createElement(Te,{socket:!0,key:"2",currentUser:this.props.currentUser,handleLogout:this.props.handleLogout,username:this.props.match.params.username,type:"USER_VOTED_POSTS",isAuthenticated:this.props.isAuthenticated})),this.props.currentUser.username===this.props.match.params.username&&o.a.createElement(Ct,{tab:"".concat(this.state.user.storageCount," Save"),key:"3"},o.a.createElement(Te,{socket:!0,key:"3",currentUser:this.props.currentUser,handleLogout:this.props.handleLogout,username:this.props.match.params.username,type:"USER_SAVE_POSTS",isAuthenticated:this.props.isAuthenticated}))))):null)}}]),a}(n.Component),yt=(a(246),a(107)),bt=(a(247),a(33)),St=(a(432),a.p+"static/media/poll.04e627bb.svg"),wt=a(452),Pt=a(124),kt=a(453),xt=c.a.Header,Nt=te.a.Search,Ut=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.loadUserNotification=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;I(e,t).then((function(e){console.log(e),n._isMounted&&n.setState({notification:n.state.notification.concat(e.content),page:e.page,last:e.last})})).catch((function(e){}))},n.handleMenuClick=function(e){var t=e.key;"logout"===t&&n.props.onLogout()},n.handleMenuClick2=function(e){var t,a=e.key;if("more"!==a){var o=n.state.notification.slice();if(n.props.currentUser.notificationCount>a){o[a].read=!0,(t=o[a].id,v({url:m+"/users/notification?id="+t,method:"PUT"})).then((function(e){})).catch((function(e){}));var s=Object(R.a)({},o[a]);o.splice(a,1),o.splice(n.props.currentUser.notificationCount-1,0,s),n.props.readNoti(),n.setState({notification:o})}n.props.history.push("/post/"+o[a].sourceId),n.setState({visible:!1})}else n.loadUserNotification(n.state.page+1)},n.handleVisibleChange=function(e){n.setState({visible:e})},n.onSearch=function(e){""===e?n.props.history.push("/"):n.props.history.push("/search/"+e),console.log(e)},n.state={notification:[],page:0,last:!1,visible:!1},n}return Object(T.a)(a,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.loadUserNotification()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e;return e=this.props.currentUser?[o.a.createElement(bt.a.Item,{key:"/"},o.a.createElement(ae.b,{to:"/"},o.a.createElement(wt.a,{className:"nav-icon"}))),o.a.createElement(bt.a.Item,{key:"/poll/new"},o.a.createElement(ae.b,{to:"/poll/new"},o.a.createElement("img",{src:St,alt:"poll",className:"poll-icon"}))),o.a.createElement(bt.a.Item,{key:"/notification",className:"profile-menu"},o.a.createElement(It,{visible:this.state.visible,handleVisibleChange:this.handleVisibleChange,last:this.state.last,notification:this.state.notification,currentUser:this.props.currentUser,handleMenuClick:this.handleMenuClick2})),o.a.createElement(bt.a.Item,{key:"/profile",className:"profile-menu"},o.a.createElement(At,{currentUser:this.props.currentUser,handleMenuClick:this.handleMenuClick}))]:[o.a.createElement(bt.a.Item,{key:"/login"},o.a.createElement(ae.b,{to:"/login"},"Login")),o.a.createElement(bt.a.Item,{key:"/signup"},o.a.createElement(ae.b,{to:"/signup"},"Signup"))],o.a.createElement(xt,{className:"app-header"},o.a.createElement("div",{style:{maxWidth:"1200px"},className:"container"},o.a.createElement("div",{className:"app-title"},o.a.createElement(ae.b,{to:"/"},"Voting App")),o.a.createElement(Nt,{placeholder:"Search question post",allowClear:!0,onSearch:this.onSearch,style:{width:200,paddingTop:15,marginLeft:"7%"}}),o.a.createElement(bt.a,{className:"app-menu",mode:"horizontal",selectedKeys:[this.props.location.pathname],style:{lineHeight:"64px"}},e)))}}]),a}(n.Component);function At(e){var t=o.a.createElement(bt.a,{onClick:function(t){return e.handleMenuClick(t,e.currentUser.username)},className:"profile-dropdown-menu"},o.a.createElement(bt.a.Item,{key:"user-info",className:"dropdown-item",disabled:!0},o.a.createElement("div",{className:"user-full-name-info"},e.currentUser.name),o.a.createElement("div",{className:"username-info"},"@",e.currentUser.username)),o.a.createElement(bt.a.Divider,null),o.a.createElement(bt.a.Item,{key:"profile",className:"dropdown-item"},o.a.createElement(ae.b,{to:"/users/".concat(e.currentUser.username)},"Profile")),o.a.createElement(bt.a.Item,{key:"updatepassword",className:"dropdown-item"},o.a.createElement(ae.b,{to:"/changepassword/".concat(e.currentUser.username)},"Change Password")),o.a.createElement(bt.a.Item,{key:"logout",className:"dropdown-item",danger:!0},"Logout"));return o.a.createElement(yt.a,{overlay:t,trigger:["click"],getPopupContainer:function(){return document.getElementsByClassName("profile-menu")[0]}},o.a.createElement("div",{className:"ant-dropdown-link"},o.a.createElement(at.a,{className:"nav-icon",style:{marginRight:0}}),o.a.createElement(Pt.a,null)))}function It(e){var t=[];e.notification.forEach((function(a,n){t.push(o.a.createElement(bt.a.Item,{key:n,className:"dropdown-item",style:a.read?{color:"#657786"}:{}},o.a.createElement("div",null,a.content),o.a.createElement("div",null,function(e){if(null==e)return"";var t=new Date(e).getTime(),a=(new Date).getTime()-t,n=Math.floor(a/1e3%60),o=Math.floor(a/1e3/60%60),s=Math.floor(a/36e5%24),r=Math.floor(a/864e5);return r>7?se(e):r>0?r+" ng\xe0y tr\u01b0\u1edbc":s>0?s+" gi\u1edd tr\u01b0\u1edbc":o>0?o+" ph\xfat tr\u01b0\u1edbc":n>0?n+" gi\xe2y tr\u01b0\u1edbc":"V\u1eeba m\u1edbi"}(a.createAt)))),n===e.currentUser.notificationCount-1&&t.push(o.a.createElement(bt.a.Divider,{key:"line"}))}));var a=o.a.createElement(bt.a,{onClick:function(t){return e.handleMenuClick(t,e.currentUser.username)},className:"scroll"},t,o.a.createElement(bt.a.Item,{key:"more",className:"dropdown-item"},!e.last&&o.a.createElement(ae.b,{to:"#"},"Load More...")));return o.a.createElement(yt.a,{overlay:a,trigger:["click"],onVisibleChange:e.handleVisibleChange,visible:e.visible,getPopupContainer:function(){return document.getElementsByClassName("profile-menu")[0]}},o.a.createElement("div",{className:"ant-dropdown-link"},o.a.createElement(z.a,{size:"small",count:e.currentUser.notificationCount,overflowCount:10}," ",o.a.createElement(kt.a,{className:"nav-icon"}))))}var Lt=Object(u.g)(Ut),Mt=a(259),Ot=function(e){var t=e.component,a=e.authenticated,n=Object(Mt.a)(e,["component","authenticated"]);return o.a.createElement(u.b,Object.assign({},n,{render:function(e){return a?o.a.createElement(t,Object.assign({},n,e)):o.a.createElement(u.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},Vt=(a(433),ee.a.Item),Dt=Ye.a.Option,Rt=Be.a.getMentions,jt=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).validateUsers=function(e){return 0===e.length?{validateStatusUser:"error",errorMsgUser:"Please enter a username!"}:e.length>g?{validateStatusUser:"error",errorMsgUser:"User is too much (Maximum ".concat(g," user allowed)")}:{validateStatusUser:"success",errorMsgUser:null}},n.loadUserList=function(e){var t;(t=x(e,"username"))&&t.then((function(e){var t=e.filter((function(e){var t=!0;return n.state.usersSend.forEach((function(a){e.username===a&&(t=!1)})),t}));n.setState({users:t,loading:!1})})).catch((function(e){}))},n.onSearch=function(e){n.setState({search:e,loading:!!e}),n.loadUserList(e)},n.onSelect=function(e){var t=Rt(e),a=[];t.forEach((function(e){a.push(e.value)})),n.setState(Object(R.a)({usersSend:a},n.validateUsers(a)))},n.validateName=function(e){return e.length<4?{validateStatus:"error",errorMsg:"Name is too short (Minimum ".concat(4," characters needed.)")}:e.length>p?{validationStatus:"error",errorMsg:"Name is too long (Maximum ".concat(p," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},n.validateGroup=function(e){return e.length<3?{validateStatus:"error",errorMsg:"GroupCode is too short (Minimum ".concat(3," characters needed.)")}:e.length>15?{validationStatus:"error",errorMsg:"GroupCode is too long (Maximum ".concat(15," characters allowed.)")}:-1!==e.indexOf(" ")?{validationStatus:"error",errorMsg:"GroupCode is valid (' ' characters not allowed.)"}:{validateStatus:null,errorMsg:null}},n.state={name:{value:""},code:{value:""},users:[],usersSend:[]},n.handleInputChange=n.handleInputChange.bind(Object(F.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(F.a)(n)),n.validateGroupCodeAvailability=n.validateGroupCodeAvailability.bind(Object(F.a)(n)),n.isFormInvalid=n.isFormInvalid.bind(Object(F.a)(n)),n}return Object(T.a)(a,[{key:"handleInputChange",value:function(e,t){var a=e.target,n=a.name,o=a.value;this.setState(Object(rt.a)({},n,Object(R.a)({value:o},t(o))))}},{key:"handleSubmit",value:function(){var e=this;(function(e){return v({url:m+"/groups",method:"POST",body:JSON.stringify(e)})})({name:this.state.name.value,code:this.state.code.value,usersUsername:this.state.usersSend}).then((function(t){l.a.success({message:"Polling App",description:"Thank you! You're successfully created group!"}),e.props.history.push("/")})).catch((function(e){l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"isFormInvalid",value:function(){return!("success"===this.state.name.validateStatus&&"success"===this.state.code.validateStatus)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"signup-container"},o.a.createElement("h1",{className:"page-title"},"Create Group"),o.a.createElement("div",{className:"signup-content"},o.a.createElement(ee.a,{onFinish:this.handleSubmit,className:"signup-form"},o.a.createElement(Vt,{label:"Full Name",validateStatus:this.state.name.validateStatus,help:this.state.name.errorMsg},o.a.createElement(te.a,{size:"large",name:"name",autoComplete:"off",placeholder:"Group name",value:this.state.name.value,onChange:function(t){return e.handleInputChange(t,e.validateName)}})),o.a.createElement(Vt,{label:"Code",hasFeedback:!0,validateStatus:this.state.code.validateStatus,help:this.state.code.errorMsg},o.a.createElement(te.a,{size:"large",name:"code",autoComplete:"off",placeholder:"A unique code",value:this.state.code.value,onBlur:this.validateGroupCodeAvailability,onChange:function(t){return e.handleInputChange(t,e.validateGroup)}})),o.a.createElement(Vt,{label:"Th\xe0nh vi\xean: ",validateStatus:this.state.validateStatusUser,help:this.state.errorMsgUser},o.a.createElement(Be.a,{style:{width:"100%"},placeholder:"Nh\u1eadp '@' \u0111\u1ec3 tag b\u1ea1n b\xe8",loading:this.state.loading,onSearch:this.onSearch,onChange:this.onSelect},this.state.users.map((function(e){var t=e.id,a=e.username,n=e.name;return o.a.createElement(Dt,{key:t,value:a,className:"antd-demo-dynamic-option"},o.a.createElement("span",null,n," @",a))})))),o.a.createElement(Vt,null,o.a.createElement(D.a,{type:"primary",htmlType:"submit",size:"large",className:"signup-form-button",disabled:this.isFormInvalid()},"Create")))))}},{key:"validateGroupCodeAvailability",value:function(){var e,t=this,a=this.state.code.value,n=this.validateGroup(a);"error"!==n.validateStatus?(this.setState({code:{value:a,validateStatus:"validating",errorMsg:null}}),(e=a,v({url:m+"/groups/checkGroupCodeAvailability?code="+e,method:"GET"})).then((function(e){e.available?t.setState({code:{value:a,validateStatus:"success",errorMsg:null}}):t.setState({code:{value:a,validateStatus:"error",errorMsg:"This username is already taken"}})})).catch((function(e){t.setState({code:{value:a,validateStatus:"success",errorMsg:null}})}))):this.setState({code:Object(R.a)({value:a},n)})}}]),a}(n.Component),Tt=(a(434),function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.loadListGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n.props.isAuthenticated){n._isMounted&&n.setState({isLoading:!0});var t=n.state.listGroups.slice();S(e,13).then((function(e){n._isMounted&&n.setState({listGroups:t.concat(e.content),isLoading:!1,last:e.last})})).catch((function(e){n._isMounted&&n.setState({isLoading:!1})}))}},n.handleCancel=function(){n.setState({visible:!1,currentGroupIndex:0})},n.onDeleteGroup=function(e){n.setState({visible:!0,currentGroupIndex:e})},n.handleDeleteGroupSubmit=function(){var e,t=n.state.listGroups.slice();(e=t[n.state.currentGroupIndex].id,v({url:m+"/groups/"+e,method:"DELETE"})).then((function(e){t.splice(n.state.currentGroupIndex,1),n.setState({listGroups:t}),l.a.success({message:"Polling App",description:e.message||"Remove User Succesfully!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),n.setState({visible:!1})},n.handleCancelLeave=function(){n.setState({visibleLeave:!1,currentGroupIndex:0})},n.onLeaveGroup=function(e){n.setState({visibleLeave:!0,currentGroupIndex:e})},n.handleLeaveGroupSubmit=function(){var e,t=n.state.listGroups.slice();(e=t[n.state.currentGroupIndex].id,v({url:m+"/groups/"+e+"/leave",method:"DELETE"})).then((function(e){t.splice(n.state.currentGroupIndex,1),n.setState({listGroups:t}),l.a.success({message:"Polling App",description:e.message||"Remove User Succesfully!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),n.setState({visibleLeave:!1})},n.state={listGroups:[],isLoading:!1,last:!1,visibleLeave:!1,visible:!1,currentGroupIndex:0},n}return Object(T.a)(a,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){this._isMounted=!0,this.loadListGroup()}},{key:"render",value:function(){var e=this,t=this.props.location,a=[];return this.state.listGroups.forEach((function(t,n){a.push(o.a.createElement(bt.a.Item,{key:"/groups/"+t.code,style:{whiteSpace:"normal",height:"auto"}},o.a.createElement(ae.b,{to:"/groups/"+t.code}),o.a.createElement("span",null,t.name),o.a.createElement(K.a,{placement:"right",title:"T\xf9y ch\u1ecdn",content:o.a.createElement(Ft,{code:t.code,onLeaveGroup:e.onLeaveGroup,onDeleteGroup:e.onDeleteGroup,currentUsername:e.props.currentUser.username,groupAdminUsername:t.usernameAdmin,groupIndex:n}),trigger:"click"},o.a.createElement(D.a,{type:"text",shape:"circle",style:{float:"right"},icon:o.a.createElement(ce.a,null)}))))})),o.a.createElement(o.a.Fragment,null,o.a.createElement(V.a,{title:"Confirm your action",visible:this.state.visible,onOk:this.handleDeleteGroupSubmit,onCancel:this.handleCancel,footer:[o.a.createElement(D.a,{key:"back",onClick:this.handleCancel},"No"),o.a.createElement(D.a,{key:"submit",type:"primary",onClick:this.handleDeleteGroupSubmit},"Yes")]},o.a.createElement("p",null,"Are you want delete this group?")),o.a.createElement(V.a,{title:"Confirm your action",visible:this.state.visibleLeave,onOk:this.handleLeaveGroupSubmit,onCancel:this.handleCancelLeave,footer:[o.a.createElement(D.a,{key:"back",onClick:this.handleCancelLeave},"No"),o.a.createElement(D.a,{key:"submit",type:"primary",onClick:this.handleLeaveGroupSubmit},"Yes")]},o.a.createElement("p",null,"Are you want leave this group?")),o.a.createElement("div",{ref:function(t){return e.scrollParentRef=t}},o.a.createElement(Me.a,{initialLoad:!1,pageStart:0,loadMore:this.loadListGroup,hasMore:!0,useWindow:!1},o.a.createElement(bt.a,{theme:"light",mode:"inline",className:"scrollbox-content",selectedKeys:[t.pathname]},o.a.createElement(bt.a.Item,{key:"/group/new",icon:o.a.createElement(he.a,null)}," ",o.a.createElement(ae.b,{to:"/group/new"}," T\u1ea1o Group")),o.a.createElement(bt.a.Divider,null),o.a.createElement(bt.a.ItemGroup,{key:"g1",title:"Nh\xf3m \u0111\xe3 tham gia"},a)))))}}]),a}(n.Component));function Ft(e){return o.a.createElement("div",null,e.currentUsername===e.groupAdminUsername&&o.a.createElement(ae.b,{to:"/editgroup/"+e.code},o.a.createElement(D.a,{type:"primary",style:{marginBottom:"10px"},block:!0},"Edit")),e.currentUsername===e.groupAdminUsername?o.a.createElement(D.a,{danger:!0,block:!0,onClick:function(){return e.onDeleteGroup(e.groupIndex)}},"Delete Group"):o.a.createElement(D.a,{danger:!0,block:!0,onClick:function(){return e.onLeaveGroup(e.groupIndex)}},"Leave"))}var Gt=Object(u.g)(Tt),_t=(a(439),a(255)),zt=a(188),Bt=ee.a.Item,Yt=Ye.a.Option,Ht=Be.a.getMentions,qt=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).validateUsers=function(e){return 0===e.length?{validateStatusUser:"error",errorMsgUser:"Please enter a username!"}:e.length>g?{validateStatusUser:"error",errorMsgUser:"User is too much (Maximum ".concat(g," user allowed)")}:{validateStatusUser:"success",errorMsgUser:null}},n.loadGroup=function(e){var t;(t=function(e){return localStorage.getItem(d)?v({url:m+"/groups/edit?code="+e,method:"GET"}):Promise.reject("No access token set.")}(e))&&(n.setState({loading:!0}),t.then((function(e){var t=n.state.name;n.setState({group:e,name:Object(R.a)(Object(R.a)({},t),{},{value:e.name}),loading:!1})})).catch((function(e){n.setState({loading:!1})})))},n.loadUserList=function(e){var t,a,o;a=e,o=n.state.code.value,(t=localStorage.getItem(d)?v({url:m+"/groups/findadd?username="+a+"&code="+o,method:"GET"}):Promise.reject("No access token set."))&&t.then((function(e){var t=e.filter((function(e){var t=!0;return n.state.usersSend.forEach((function(a){e.username===a&&(t=!1)})),t}));n.setState({users:t,loading:!1})})).catch((function(e){}))},n.onSearch=function(e){n.setState({search:e,loading:!!e}),n.loadUserList(e)},n.onSelect=function(e){var t=Ht(e),a=[];t.forEach((function(e){a.push(e.value)})),n.setState(Object(R.a)({usersSend:a},n.validateUsers(a)))},n.getColumnSearchProps=function(e){return{filterDropdown:function(t){var a=t.setSelectedKeys,s=t.selectedKeys,r=t.confirm,l=t.clearFilters;return o.a.createElement("div",{style:{padding:8}},o.a.createElement(te.a,{ref:function(e){n.searchInput=e},placeholder:"Search ".concat(e),value:s[0],onChange:function(e){return a(e.target.value?[e.target.value]:[])},onPressEnter:function(){return n.handleSearch(s,r,e)},style:{marginBottom:8,display:"block"}}),o.a.createElement(Ge.b,null,o.a.createElement(D.a,{type:"primary",onClick:function(){return n.handleSearch(s,r,e)},icon:o.a.createElement(zt.a,null),size:"small",style:{width:90}},"Search"),o.a.createElement(D.a,{onClick:function(){return n.handleReset(l)},size:"small",style:{width:90}},"Reset"),o.a.createElement(D.a,{type:"link",size:"small",onClick:function(){r({closeDropdown:!1}),n.setState({searchText:s[0],searchedColumn:e})}},"Filter")))},filterIcon:function(e){return o.a.createElement(zt.a,{style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return a[e]?a[e].toString().toLowerCase().includes(t.toLowerCase()):""},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return n.searchInput.select()}),100)},render:function(e){return n.state.searchedColumn,e}}},n.handleSearch=function(e,t,a){t(),n.setState({searchText:e[0],searchedColumn:a})},n.handleReset=function(e){e(),n.setState({searchText:""})},n.handleCancel=function(){n.setState({visible:!1,currentUserId:0,currentUserIndex:0})},n.onDeleteUser=function(e,t){n.setState({visible:!0,currentUserId:e,currentUserIndex:t})},n.onChange=function(e,t,a,n){},n.handleDeleteUserSubmit=function(){var e,t,a=n.state.group,o=n.state.group.member.slice();(e=a.id,t=n.state.currentUserId,v({url:m+"/groups/"+e+"/user?user="+t,method:"DELETE"})).then((function(e){o.splice(n.state.currentUserIndex,1),a.member=o,n.setState({group:a}),l.a.success({message:"Polling App",description:e.message||"Remove User Succesfully!"})})).catch((function(e){401===e.status?n.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})})),n.setState({visible:!1})},n.validateName=function(e){return e.length<4?{validateStatus:"error",errorMsg:"Name is too short (Minimum ".concat(4," characters needed.)")}:e.length>p?{validationStatus:"error",errorMsg:"Name is too long (Maximum ".concat(p," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},n.state={name:{value:"",validateStatus:"success"},code:{value:""},users:[],usersSend:[],group:{member:[]},loading:!1,visible:!1,currentUserId:0,currentUserIndex:0},n.handleInputChange=n.handleInputChange.bind(Object(F.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(F.a)(n)),n.isFormInvalid=n.isFormInvalid.bind(Object(F.a)(n)),n}return Object(T.a)(a,[{key:"componentDidUpdate",value:function(e){this.props.match.params.code!==e.match.params.code&&(this.setState({name:{value:"",validateStatus:"success"},code:{value:""},users:[],usersSend:[],group:{member:[]},loading:!1}),this.setState({code:{value:this.props.match.params.code}}),this.loadGroup(this.props.match.params.code))}},{key:"componentWillUnmount",value:function(){}},{key:"componentDidMount",value:function(){this.setState({code:{value:this.props.match.params.code}}),this.loadGroup(this.props.match.params.code)}},{key:"handleInputChange",value:function(e,t){var a=e.target,n=a.name,o=a.value;this.setState(Object(rt.a)({},n,Object(R.a)({value:o},t(o))))}},{key:"handleSubmit",value:function(){var e=this;(function(e){return v({url:m+"/groups/edit",method:"POST",body:JSON.stringify(e)})})({name:this.state.name.value,code:this.state.code.value,usersUsername:this.state.usersSend}).then((function(t){l.a.success({message:"Polling App",description:"Thank you! You're successfully created group!"}),e.props.history.push("/groups/"+e.state.code.value)})).catch((function(e){l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"isFormInvalid",value:function(){return!("success"===this.state.name.validateStatus)}},{key:"render",value:function(){var e=this,t=[Object(R.a)({title:"M\xe3",dataIndex:"id",key:"id",sorter:{compare:function(e,t){return e.id-t.id},multiple:4},width:100,fixed:"left"},this.getColumnSearchProps("id")),Object(R.a)({title:"Username",dataIndex:"username",key:"username",sorter:{compare:function(e,t){return e.username.length-t.username.length},multiple:3},width:150,fixed:"left"},this.getColumnSearchProps("username")),Object(R.a)({title:"Name",dataIndex:"name",key:"name",sorter:{compare:function(e,t){return e.name.length-t.name.length},multiple:2},width:100},this.getColumnSearchProps("name")),{title:"Avatar",dataIndex:"photo",key:"photo",width:100,render:function(e){return null==e?"No Image":o.a.createElement(O.a,{src:"https://drive.google.com/uc?export=view&id="+e})}},{title:"Action",dataIndex:"action",key:"action",width:90,fixed:"right",render:function(t,a,n){return a.username!==e.state.group.usernameAdmin&&o.a.createElement(D.a,{type:"danger",onClick:function(){return e.onDeleteUser(a.id,n)}},"Delete")}}];return o.a.createElement(o.a.Fragment,null,o.a.createElement(V.a,{title:"Confirm your action",visible:this.state.visible,onOk:this.handleDeleteUserSubmit,onCancel:this.handleCancel,footer:[o.a.createElement(D.a,{key:"back",onClick:this.handleCancel},"No"),o.a.createElement(D.a,{key:"submit",type:"primary",onClick:this.handleDeleteUserSubmit},"Yes")]},o.a.createElement("p",null,"Are you want delete this user?")),o.a.createElement("div",{className:"signup-container"},o.a.createElement("h1",{className:"page-title"},"Edit Group"),o.a.createElement("div",{className:"signup-content"},o.a.createElement(ee.a,{onFinish:this.handleSubmit,className:"signup-form"},o.a.createElement(Bt,{label:"Full Name",validateStatus:this.state.name.validateStatus,help:this.state.name.errorMsg},o.a.createElement(te.a,{size:"large",name:"name",autoComplete:"off",placeholder:"Group name",value:this.state.name.value,onChange:function(t){return e.handleInputChange(t,e.validateName)}})),o.a.createElement(Bt,{label:"Code"},o.a.createElement(te.a,{size:"large",name:"code",autoComplete:"off",placeholder:"A unique code",value:this.state.code.value,disabled:!0,onChange:function(t){return e.handleInputChange(t)}})),o.a.createElement(Bt,{label:"Th\xeam th\xe0nh vi\xean: ",validateStatus:this.state.validateStatusUser,help:this.state.errorMsgUser},o.a.createElement(Be.a,{style:{width:"100%"},placeholder:"Nh\u1eadp '@' \u0111\u1ec3 tag b\u1ea1n b\xe8",loading:this.state.loading,onSearch:this.onSearch,onChange:this.onSelect},this.state.users.map((function(e){var t=e.id,a=e.username,n=e.name;return o.a.createElement(Yt,{key:t,value:a,className:"antd-demo-dynamic-option"},o.a.createElement("span",null,n," @",a))})))),o.a.createElement(Bt,null,o.a.createElement(D.a,{type:"primary",htmlType:"submit",size:"large",className:"signup-form-button",disabled:this.isFormInvalid()},"Update"))))),o.a.createElement(_t.a,{columns:t,dataSource:this.state.group.member,rowKey:"id",onChange:this.onChange}))}}]),a}(n.Component),Wt=ee.a.Item,Kt=function(e){Object(G.a)(a,e);var t=Object(_.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).validatePassword=function(e){return e.length<6?{validateStatus:"error",errorMsg:"Password is too short (Minimum ".concat(6," characters needed.)")}:e.length>20?{validationStatus:"error",errorMsg:"Password is too long (Maximum ".concat(20," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},n.state={newpassword:{value:""},currentpassword:{value:""}},n.handleInputChange=n.handleInputChange.bind(Object(F.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(F.a)(n)),n.isFormInvalid=n.isFormInvalid.bind(Object(F.a)(n)),n}return Object(T.a)(a,[{key:"handleInputChange",value:function(e,t){var a=e.target,n=a.name,o=a.value;this.setState(Object(rt.a)({},n,Object(R.a)({value:o},t(o))))}},{key:"handleSubmit",value:function(){var e,t=this,a={newPassword:this.state.newpassword.value,currentPassword:this.state.currentpassword.value};(e=a,v({url:m+"/user/changepassword",method:"PUT",body:JSON.stringify(e)})).then((function(e){l.a.success({message:"Polling App",description:"Thank you! You're successfully update password!"}),t.props.history.push("/users/"+t.props.currentUser.username)})).catch((function(e){l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"isFormInvalid",value:function(){return!("success"===this.state.newpassword.validateStatus&&"success"===this.state.currentpassword.validateStatus)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"signup-container"},o.a.createElement("h1",{className:"page-title"},"Change Password"),o.a.createElement("div",{className:"signup-content"},o.a.createElement(ee.a,{onFinish:this.handleSubmit,className:"signup-form"},o.a.createElement(Wt,{label:"Current Password",validateStatus:this.state.currentpassword.validateStatus,help:this.state.currentpassword.errorMsg},o.a.createElement(te.a.Password,{prefix:o.a.createElement(nt.a,null),size:"large",name:"currentpassword",type:"password",autoComplete:"off",placeholder:"Your curent password",value:this.state.currentpassword.value,onChange:function(t){return e.handleInputChange(t,e.validatePassword)}})),o.a.createElement(Wt,{label:"New Password",validateStatus:this.state.newpassword.validateStatus,help:this.state.newpassword.errorMsg},o.a.createElement(te.a.Password,{prefix:o.a.createElement(nt.a,null),size:"large",name:"newpassword",type:"password",autoComplete:"off",placeholder:"Your new password",value:this.state.newpassword.value,onChange:function(t){return e.handleInputChange(t,e.validatePassword)}})),o.a.createElement(Wt,null,o.a.createElement(D.a,{type:"primary",htmlType:"submit",size:"large",className:"signup-form-button",disabled:this.isFormInvalid()},"Update Password")))))}}]),a}(n.Component),Jt=c.a.Header,Qt=c.a.Sider,$t=c.a.Content,Xt=Object(u.g)((function(e){var t=Object(n.useState)(null),a=Object(i.a)(t,2),s=a[0],r=a[1],h=Object(n.useState)(!1),p=Object(i.a)(h,2),g=p[0],f=p[1],C=Object(n.useState)(!1),E=Object(i.a)(C,2),y=E[0],b=E[1];l.a.config({placement:"topRight",top:70,duration:3}),Object(n.useEffect)((function(){S()}),[]);var S=function(){b(!0),(localStorage.getItem(d)?v({url:m+"/user/me",method:"GET"}):Promise.reject("No access token set.")).then((function(e){r(e),f(!0),b(!1)})).catch((function(e){b(!1)}))},w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"You're successfully logged out.";localStorage.removeItem(d),r(null),f(!1),e.history.push(t),l.a[a]({message:"Polling App",description:n})},P=function(){l.a.success({message:"Polling App",description:"You're successfully logged in."}),S(),e.history.push("/")};return y?o.a.createElement(Ae,null):o.a.createElement(c.a,{className:"app-container"},o.a.createElement(Jt,null,o.a.createElement(Lt,{readNoti:function(){s.notificationCount--,r(s)},isAuthenticated:g,currentUser:s,onLogout:w})),o.a.createElement(c.a,null,o.a.createElement(Qt,{style:{height:"100vh",position:"fixed",maxHeight:"calc(100% - 64px)",left:0},className:"sider scrollbox scrollbox_delayed"},g&&o.a.createElement(Gt,{key:"/group/new"===e.location.pathname?1:-1!==e.location.pathname.indexOf("/editgroup/")?2:3,currentUser:s,isAuthenticated:g})),o.a.createElement($t,{className:"app-content"},o.a.createElement("div",{className:"container"},o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:"/",render:function(e){return o.a.createElement(Te,Object.assign({isAuthenticated:g,currentUser:s,handleLogout:w,type:"HOME"},e))}}),o.a.createElement(u.b,{path:"/login",render:function(e){return o.a.createElement(st,Object.assign({onLogin:P,type:"login"},e))}}),o.a.createElement(u.b,{path:"/auth/:code",render:function(e){return o.a.createElement(st,Object.assign({onLogin:P,type:"confirm"},e))}}),o.a.createElement(u.b,{path:"/signup",component:it}),o.a.createElement(u.b,{path:"/users/:username",render:function(e){return o.a.createElement(Et,Object.assign({isAuthenticated:g,handleLogout:w,key:e.match.params.username,currentUser:s},e))}}),o.a.createElement(u.b,{path:"/post/:id",authenticated:g,render:function(e){return o.a.createElement(Te,Object.assign({isAuthenticated:g,currentUser:s,key:e.match.params.id,handleLogout:w,type:"ONE_POST"},e))}}),o.a.createElement(u.b,{path:"/search/:search",authenticated:g,render:function(e){return o.a.createElement(Te,Object.assign({isAuthenticated:g,currentUser:s,key:e.match.params.search,handleLogout:w,type:"SEARCH_POST"},e))}}),o.a.createElement(u.b,{authenticated:g,path:"/groups/:code",render:function(e){return o.a.createElement(Te,Object.assign({isAuthenticated:g,currentUser:s,handleLogout:w,type:"GROUP"},e))}}),o.a.createElement(Ot,{authenticated:g,path:"/changepassword/:username",currentUser:s,component:Kt,handleLogout:w}),o.a.createElement(Ot,{authenticated:g,path:"/editgroup/:code",component:qt,handleLogout:w}),o.a.createElement(Ot,{authenticated:g,path:"/poll/new",component:tt,handleLogout:w}),o.a.createElement(Ot,{authenticated:g,path:"/group/new",component:jt,handleLogout:w}),o.a.createElement(u.b,{component:ht}))))))})),Zt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ea(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}r.a.render(o.a.createElement(ae.a,null,o.a.createElement(Xt,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/poll-client",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/poll-client","/service-worker.js");Zt?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ea(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):ea(e)}))}}()}},[[437,1,2]]]);
//# sourceMappingURL=main.6b3d2c31.chunk.js.map